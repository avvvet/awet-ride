(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{219:function(e,t,a){"use strict";e.exports={ROUTING_SERVICE:"https://nileride.com/route/v1"}},278:function(e,t,a){e.exports=a(571)},283:function(e,t,a){},564:function(e,t){},569:function(e,t,a){},571:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(12),o=a.n(i),l=(a(283),a(17)),s=a(18),c=a(26),d=a(19),u=a(25),m=a(596),p=a(600),g=a(573),h=a(11),v=a.n(h),f=a(599),b=a(598),E=a(597),y=a(594),_=a(241),O=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={pickupAdress:"Lord my God you have plan in my life",locationGroup:"",pickup_latlng:{lat:0,lng:0}},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=v.a.map("mapid");t.locate({setView:!0,maxZoom:17}),v.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(t),this.setState({locationGroup:(new v.a.LayerGroup).addTo(t)}),t.on("locationfound",function(a){var r=e.state.locationGroup,n=a.accuracy/1024;n=n.toFixed(2),v.a.marker(a.latlng).addTo(r).bindPopup("You are "+n+" meters from this point").openPopup(),v.a.circle(a.latlng,n).addTo(r),t.setView(a.latlng,15),e.setState({currentLatLng:a.latlng})}),t.on("locationerror",function(e){console.log("location error",e.message)})}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",{className:"div-branch",id:"div-branch"},n.a.createElement(b.a,{container:!0,columns:1,centered:!0,stackable:!0},n.a.createElement(b.a.Row,{columns:1},n.a.createElement(b.a.Column,{mobile:12,tablet:12,computer:12},n.a.createElement(E.a,{size:"huge",color:"black",textAlign:"center"},"You are ?"))),n.a.createElement(b.a.Row,{columns:1},n.a.createElement(b.a.Column,{mobile:12,tablet:12,computer:12},n.a.createElement(y.a,{color:"teal",size:"massive",as:f.a,to:"/user/login",fluid:!0},"PASSENGER"))),n.a.createElement(b.a.Row,{columns:1},n.a.createElement(b.a.Column,{mobile:12,tablet:12,computer:12},n.a.createElement(E.a,{size:"small",color:"black",textAlign:"center"},n.a.createElement(_.a,{circular:!0,color:"black"},"OR")))),n.a.createElement(b.a.Row,{columns:1},n.a.createElement(b.a.Column,{mobile:12,tablet:12,computer:12},n.a.createElement(y.a,{color:"green",size:"massive",as:f.a,to:"/driver/login",fluid:!0},"DRIVER"))))),n.a.createElement("div",{className:"mapid",id:"mapid"}))}}]),t}(r.Component),C=a(590),w=a(580),j=a(581),S=a(582),k=a(583),I=(r.Component,a(35)),R=a(5),N=a(592),x=a(591),P=a(572),L=a(589),T=a(595),A=a(148),B=a(28),F=a.n(B),D=a(47),M=a.n(D),U=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this)))._yes=function(t){e.setState({_show_confirm:!1,_show_reason:!0})},e._no=function(e){Object(i.render)("",document.getElementById("div-notification-1")),document.getElementById("div-notification-1").style.visibility="hidden"},e._driver_busy_ok=function(t){F.a.ajax({type:"POST",url:"/ride/busy_ok",headers:{"x-auth":sessionStorage.getItem("_auth_user")},data:JSON.stringify({}),contentType:"application/json",success:function(e,t,a){this.props.resetRide(),Object(i.render)("",document.getElementById("div-notification-1")),document.getElementById("div-notification-1").style.visibility="hidden"}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){}.bind(Object(R.a)(Object(R.a)(e)))})},e.state={_show_confirm:!0,_show_reason:!1,_reason:""},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(N.a,{negative:!0},n.a.createElement(N.a.Header,null,"Sorry, all drivers are busy !"),n.a.createElement("p",null,"we have tried to assign your ride to nearest drivers. At this moment all drivers are busy. Please try to request again."),n.a.createElement("p",null,n.a.createElement(b.a,{columns:1},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18,textAlign:"center"},n.a.createElement(y.a,{color:"green",onClick:function(t){return e._driver_busy_ok(t)}},"OK"))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{xs:18,sm:18,md:18},n.a.createElement("div",{className:"div-error",id:"driver-busy-error"})))))))}}]),t}(r.Component),G=a(601),z=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this)))._yes=function(t){e.setState({_show_confirm:!1,_show_reason:!0})},e._no=function(e){Object(i.render)("",document.getElementById("div-notification-1")),document.getElementById("div-notification-1").style.visibility="hidden"},e._on_rating=function(t){0===e.state.rating?Object(i.render)(n.a.createElement(N.a,{negative:!0}," Please select stars !   (1 star is bad and 5 star  is excellent)"),document.getElementById("div-rateing-error")):e._rating(t)},e._rating=function(t){var a={ride_id:e.state._ride_id,driver_id:e.state._driver_id,rating:e.state.rating};F.a.ajax({type:"POST",url:"/ride/rating",headers:{"x-auth":sessionStorage.getItem("_auth_user")},data:JSON.stringify(a),contentType:"application/json",success:function(e,t,a){this.props.resetRide(),Object(i.render)("",document.getElementById("div-notification-1")),document.getElementById("div-notification-1").style.visibility="hidden"}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){}.bind(Object(R.a)(Object(R.a)(e)))})},e.handleRate=function(t,a){var r=a.rating,n=a.maxRating;return e.setState({rating:r,maxRating:n})},e.state={rating:0,maxRating:5,_driverImage:"",_driverCarImage:"",_driverName:""},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.setState({_ride_id:this.props.ride.id,_driver_id:this.props.ride.driver_id,_driverImage:"/assets/profile/driver/"+this.props.ride.driver.profile,_driverCarImage:"/assets/awet-ride.jpeg",_driverName:this.props.ride.driver.firstName+" "+this.props.ride.driver.middleName})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(N.a,null,n.a.createElement(N.a.Header,null,"How was the driver and car ?"),n.a.createElement("p",null,"Please rate from 1 to 5 star."),n.a.createElement("p",null,n.a.createElement(b.a,{container:!0,columns:1,centered:!0},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16,textAlign:"center"},n.a.createElement(G.a,{maxRating:5,onRate:this.handleRate,icon:"star",size:"massive"}))),n.a.createElement(b.a.Row,{className:"row_xs"},n.a.createElement(b.a.Column,{mobile:5,tablet:5,computer:5,textAlign:"center"},n.a.createElement(P.a,{src:this.state._driverImage,height:40,circular:!0})),n.a.createElement(b.a.Column,{mobile:5,tablet:5,computer:5,textAlign:"center"},n.a.createElement(P.a,{src:this.state._driverCarImage,height:40,circular:!0})),n.a.createElement(b.a.Column,{mobile:6,tablet:6,computer:6,className:"text-center",textAlign:"center"},this.state._driverName)),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16,textAlign:"center"},n.a.createElement(y.a,{color:"green",onClick:function(t){return e._on_rating(t)},fluid:!0},"SEND"))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16,textAlign:"center"},n.a.createElement("div",{id:"div-rateing-error"})))))))}}]),t}(r.Component),V=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,"Thank You")}}]),t}(r.Component),q=(a(457),a(219)),H=a(103),J=(v.a.icon({iconUrl:"/assets/awet-rider-m.png",shadowUrl:"",iconSize:[40,40],shadowSize:[50,64],iconAnchor:[12,50],shadowAnchor:[4,62],popupAnchor:[-1,-45]}),v.a.icon({iconUrl:"/assets/marker_a.png",shadowUrl:"",iconSize:[40,40],shadowSize:[50,64],iconAnchor:[20,39],shadowAnchor:[4,62],popupAnchor:[-1,-45]})),Y=v.a.icon({iconUrl:"/assets/marker_b.png",shadowUrl:"",iconSize:[40,40],shadowSize:[50,64],iconAnchor:[20,39],shadowAnchor:[4,62],popupAnchor:[-1,-45]}),W=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).userCurrentLocation=function(){new Promise(function(t,a){e.getDrivers(),e.state.map.locate({setView:!0,maxZoom:17}),t(!0)}).then(function(t){if(!M.a.isEqual(e.state.current_latlng,e.state.last_current_latlng)){e.setState({last_current_latlng:e.state.current_latlng});var a={_latlng:"POINT(".concat(e.state.current_latlng.lat," ").concat(e.state.current_latlng.lng,")")},r=sessionStorage.getItem("_auth_user");F.a.ajax({type:"POST",url:"/user/updateLocation",headers:{"x-auth":r},data:JSON.stringify(a),contentType:"application/json",success:function(e,t,a){}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})}})},e.getList=function(){fetch("/api/getList").then(function(e){return e.json()}).then(function(t){return e.setState({list:t})})},e.getDrivers=function(t){var a=v.a.icon({iconUrl:"/assets/awet-ride-marker-1.png",shadowUrl:"",iconSize:[70,39],shadowSize:[50,64],iconAnchor:[22,94],shadowAnchor:[4,62],popupAnchor:[-3,-76]});F.a.ajax({type:"GET",url:"/drivers",contentType:"application/json",success:function(e,t,r){var n=this.state.carMarkerGroup;if(n.clearLayers(),e)for(var i=0;i<e.length;i++)v.a.marker([e[i].currentLocation[0],e[i].currentLocation[1]],{icon:a}).bindPopup(e[i].firstName+" "+e[i].middleName+" <br> Plate : "+e[i].plateNo).addTo(n)}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.log("getdrivers error",a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.getNearestDrivers=function(t){var a={pickup_latlng:"POINT(".concat(e.state.pickup_latlng.lat," ").concat(e.state.pickup_latlng.lng,")")};F.a.ajax({type:"POST",url:"/drivers/nearest",data:JSON.stringify(a),contentType:"application/json",success:function(e,a,r){console.log("nearest driver",e,"pickup",t),e.length>0?this.setState({_nearest_driver_token:e[0].token,_nearest_driver_distance:e[0].distance,_nearest_driver_latlng:e[0].currentLocation.coordinates,_nearest_driver_available:!0}):this.setState({_nearest_driver_available:!1})}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.error("erroorror",a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.getUser=function(t){F.a.ajax({type:"GET",url:"/user/get",headers:{"x-auth":t},contentType:"application/json",success:function(e,t,a){e&&(console.log("user is ",e),this.setState({user:e,isLogedIn:!0,_signInFlag:!1}))}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.log("getdriver",a.toString()),console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.findRoute=function(t,a){document.getElementById("ride-route-status").innerHTML="Please wait ...",document.getElementById("ride-route-status").style.visibility="visible",document.getElementById("ride-price-dashboard").style.visibility="hidden",document.getElementById("ride-route-try").style.visibility="hidden";var r=e.state.map;e.routeControl&&(r.removeControl(e.routeControl),e.routeControl=null),e.routeControl=v.a.Routing.control({waypoints:[v.a.latLng(t),v.a.latLng(a)],routeWhileDragging:!1,addWaypoints:!1,show:!1,showAlternatives:!1,createMarker:function(){return null},lineOptions:{styles:[{color:"red",opacity:1,weight:3}]},router:v.a.Routing.osrmv1({serviceUrl:q.ROUTING_SERVICE})}).on("routesfound",e.routeFound).on("routingerror",function(e){console.log(e.error.status),-1===e.error.status&&(document.getElementById("ride-price-dashboard").style.visibility="hidden",document.getElementById("ride-route-status").style.visibility="hidden",document.getElementById("ride-route-try").style.visibility="visible")}).addTo(r)},e.routeFound=function(t){var a=t.routes,r=a[0].summary.totalDistance,n=a[0].summary.totalTime;r=(r/1e3).toFixed(2);var i=function(e){var t=e/3600,a=Math.floor(t),r=60*(t-a),n=Math.round(r);return(a>0?a+" hr":"")+(n>0?n+" min":"")}(Number.parseInt(n));var o=(10*r).toFixed(2);e.setState({route_distance:Number.parseFloat(r).toFixed(2),route_price:o,route_time:n,route_time_string:i,isRouteFound:!0}),document.getElementById("ride-route-try").style.visibility="hidden",document.getElementById("ride-route-status").style.visibility="hidden",document.getElementById("ride-price-dashboard").style.visibility="visible",e.nearestDriverRouteInfo(e.state.pickup_latlng,e.state._nearest_driver_latlng)},e.nearestDriverRouteInfo=function(t,a){console.log("neareest data ",a,t);var r=e.state.map;e._neearest_driver_routeControl&&(r.removeControl(e._neearest_driver_routeControl),e._neearest_driver_routeControl=null),e._neearest_driver_routeControl=v.a.Routing.control({waypoints:[v.a.latLng(t),v.a.latLng(a)],routeWhileDragging:!1,addWaypoints:!1,show:!1,showAlternatives:!1,createMarker:function(){return null},router:v.a.Routing.osrmv1({serviceUrl:q.ROUTING_SERVICE})}).on("routesfound",function(t){var a=t.routes,r=a[0].summary.totalDistance,n=a[0].summary.totalTime;r=(r/1e3).toFixed(2);var i=function(e){var t=e/3600,a=Math.floor(t),r=60*(t-a),n=Math.round(r);return(a>0?a+" hr":"")+(n>0?n+" min":"")}(Number.parseInt(n));e.setState({_nearest_driver_eta:i});var o=e.state.map;e._neearest_driver_routeControl&&(o.removeControl(e._neearest_driver_routeControl),e._neearest_driver_routeControl=null)}).on("routingerror",function(e){console.log(e.error.status),e.error.status}).addTo(r)},e.getDriverEta=function(t,a){console.log("data data ",t);var r=e.state.map;e.routeControl&&(r.removeControl(e.routeControl),e.routeControl=null),e.routeControl=v.a.Routing.control({waypoints:[v.a.latLng(e.state._driverCurrentLocation),v.a.latLng(t)],routeWhileDragging:!1,addWaypoints:!1,show:!1,showAlternatives:!1,createMarker:function(){return null},lineOptions:{styles:[{color:"blue",opacity:1,weight:4}]},router:v.a.Routing.osrmv1({serviceUrl:q.ROUTING_SERVICE})}).on("routesfound",function(t){var r=t.routes,n=r[0].summary.totalDistance,i=r[0].summary.totalTime;n=(n/1e3).toFixed(2);var o=function(e){var t=e/3600,a=Math.floor(t),r=60*(t-a),n=Math.round(r);return(a>0?a+" hr":"")+(n>0?n+" min":"")}(Number.parseInt(i));"pickup"===a?document.getElementById("notify-rider").innerHTML="Get ready, driver is "+o+" away !":document.getElementById("notify-rider_2").innerHTML="Ride inprogress. "+o+" to dropoff !";var l=e.state.map;e._neearest_driver_routeControl&&(l.removeControl(e._neearest_driver_routeControl),e._neearest_driver_routeControl=null)}).on("routingerror",function(e){console.log("driver eta route erro",e.error.status),e.error.status}).addTo(r)},e.rideRequest=function(t){var a={user_id:sessionStorage.getItem("_auth_user"),driver_id:e.state._nearest_driver_token,pickup_latlng:"POINT(".concat(e.state.pickup_latlng.lat," ").concat(e.state.pickup_latlng.lng,")"),dropoff_latlng:"POINT(".concat(e.state.dropoff_latlng.lat," ").concat(e.state.dropoff_latlng.lng,")"),route_distance:e.state.route_distance,route_time:e.state.route_time,route_price:e.state.route_price,status:1};F.a.ajax({type:"POST",url:"/ride/rideRequest",headers:{"x-auth":sessionStorage.getItem("_auth_user")},data:JSON.stringify(a),contentType:"application/json",success:function(e,t,a){console.log("repy of request ",e),M.a.isNull(e)||(console.log("yes yes yes "),this.rideRequestAction(e))}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.log("ride request reply error",e.status),console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.chkTimerRideStatus=function(){M.a.isNull(e.timerRideStatus)&&(e.timerRideStatus=setInterval(e.checkRideStatus,7e3))},e.rideRequestAction=function(t){document.getElementById("ride-price-dashboard").style.visibility="hidden",document.getElementById("ride-request-dashboard").style.visibility="visible",e.chkTimerRideStatus(),console.log("ride request sucess res ",t)},e.checkRideStatus=function(){F.a.ajax({type:"POST",url:"/ride/check_ride_user",headers:{"x-auth":sessionStorage.getItem("_auth_user")},data:JSON.stringify({status:7}),contentType:"application/json",success:function(e,t,a){var r,o,l,s=this;(console.log("what is this ",e),M.a.isNull(e.status))?(document.getElementById("ride-request-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard-2").style.visibility="hidden",clearInterval(this.timerDriverEta_pickup),clearInterval(this.timerDriverEta_dropoff),clearInterval(this.timerRideStatus),this.timerRideStatus=null,this.resetRide()):(e.driver.cars.length>0&&(r=e.driver.cars[0].model,o=e.driver.cars[0].plate_no),0!==e.status&&(l=new Promise(function(t,a){s.setState({_driverImage:"/assets/profile/driver/"+e.driver.profile,_driverCarImage:"/assets/awet-ride.jpeg",_driverName:e.driver.firstName+" "+e.driver.middleName,_driverPlateNo:o,_driverMobile:e.driver.mobile,_driverCarModel:r,_driverCurrentLocation:e.driver.currentLocation.coordinates,pickup_latlng:e.pickup_latlng.coordinates,dropoff_latlng:e.dropoff_latlng.coordinates,pickup_flag:"on",dropoff_flag:"on"}),clearInterval(s.timerUserLocation),t(!0)})),1===e.status?this.rideRequestAction(e):7===e.status?l.then(function(){document.getElementById("ride-request-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard").style.visibility="visible",s.checkEtaPickUp(s.state.pickup_latlng,"pickup")}):77===e.status?l.then(function(){document.getElementById("u-driver-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard-2").style.visibility="visible",s.checkEtaDropOff(s.state.dropoff_latlng,"dropoff")}):4===e.status?l.then(function(){document.getElementById("ride-request-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard-2").style.visibility="hidden",document.getElementById("driver-cancel-ride").style.visibility="visible",clearInterval(s.timerDriverEta_pickup),clearInterval(s.timerDriverEta_dropoff),clearInterval(s.timerRideStatus)}):0===e.status?(document.getElementById("ride-request-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard-2").style.visibility="hidden",clearInterval(this.timerDriverEta_pickup),clearInterval(this.timerDriverEta_dropoff),clearInterval(this.timerRideStatus),this.resetRide()):2===e.status?(document.getElementById("ride-request-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard-2").style.visibility="hidden",document.getElementById("div-notification-1").style.visibility="visible",Object(i.render)(n.a.createElement(U,{resetRide:this.resetRide}),document.getElementById("div-notification-1")),clearInterval(this.timerDriverEta_pickup),clearInterval(this.timerDriverEta_dropoff),clearInterval(this.timerRideStatus)):7777===e.status&&(document.getElementById("ride-request-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard-2").style.visibility="hidden",document.getElementById("div-notification-1").style.visibility="visible",Object(i.render)(n.a.createElement(z,{resetRide:this.resetRide,ride:e}),document.getElementById("div-notification-1")),clearInterval(this.timerDriverEta_pickup),clearInterval(this.timerDriverEta_dropoff),clearInterval(this.timerRideStatus)))}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.checkEtaPickUp=function(t,a){M.a.isUndefined(e.timerDriverEta_pickup)&&(e.timerDriverEta_pickup=setInterval(e.getDriverEta,1e4,t,a))},e.checkEtaDropOff=function(t,a){M.a.isUndefined(e.timerDriverEta_dropoff)&&(clearInterval(e.timerDriverEta_pickup),e.timerDriverEta_dropoff=setInterval(e.getDriverEta,1e4,t,a))},e.resetRide=function(){document.getElementById("ride-price-dashboard").style.visibility="hidden",document.getElementById("ride-route-try").style.visibility="hidden";var t=e.state.map;e.routeControl&&(t.removeControl(e.routeControl),e.routeControl=null),e.state.markerGroup.clearLayers(),e.setState({pickup_flag:"off",dropoff_flag:"off",isRouteFound:!1,rideCompleteFlag:!1}),t.locate({setView:!0,maxZoom:15}),e.timerUserLocation=setInterval(e.userCurrentLocation,1e4),e.timerRideStatus=null},e.cancelRide=function(){document.getElementById("ride-price-dashboard").style.visibility="hidden";var t=e.state.map;e.routeControl&&(t.removeControl(e.routeControl),e.routeControl=null),e.state.markerGroup.clearLayers(),e.setState({pickup_flag:"off",dropoff_flag:"off",isRouteFound:!1,rideCompleteFlag:!1}),t.locate({setView:!0,maxZoom:15}),e.timerUserLocation=setInterval(e.userCurrentLocation,1e4)},e.validateVarification=function(){var t=[];return 0===e.state.varificationCode.length?t.push("Varification field is empty."):!1===H.isLength(e.state.varificationCode,{min:5})?t.push("Code must not be less than 5 characters"):!1===H.isLength(e.state.varificationCode,{max:5})?t.push("Code is greater than 5 characters"):!1===H.isNumeric(e.state.varificationCode,{no_symbols:!0})&&t.push("Varification number is not valid"),t},e.validateProfile=function(){console.log("file",e.state.file);var t=[];if(0===e.state.file.length&&t.push("Picture is empty. Browse first."),e.state.file.size>1024e3&&t.push("Selected Picture is very large"),e.state.file.size>0){var a=e.state.file.type.split("/").pop().toLowerCase();console.log("ttt",a),"jpeg"!=a&&"jpg"!=a&&"png"!=a&&"bmp"!=a&&"gif"!=a&&t.push("Please select a valid image file")}return t},e.change=function(t){e.setState(Object(I.a)({},t.target.name,t.target.value))},e._onChange_profile=function(t){t.preventDefault();var a=new FileReader,r=t.target.files[0];a.onloadend=function(){e.setState({file:r,imagePreviewUrl:a.result})},a.readAsDataURL(r)},e.onProfileUpload=function(t){t.target.disabled=!0,t.preventDefault();var a=e.validateProfile();if(a.length>0){t.target.disabled=!1;var r=e.getErrorList(a);Object(i.render)(n.a.createElement(N.a,{bsStyle:"danger"},r),document.getElementById("ProfileError"))}else e.uploadProfile(t),e.setState({file:"",imagePreviewUrl:"",errors:[]})},e.onVarify=function(t){t.preventDefault();var a=e.validateVarification();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement("div",null,r),document.getElementById("FormError"))}else{var o={varification_code:e.state.varificationCode};e.varify(o),e.setState({varificationCode:"",errors:[]})}},e.varify=function(t){F.a.ajax({type:"POST",url:"/user/mobile_verification",headers:{"x-auth":sessionStorage.getItem("_auth_user")},data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){e&&(Object(i.render)(n.a.createElement(V,null),document.getElementById("account-verfiy")),this.getUser(sessionStorage.getItem("_auth_user")))}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){Object(i.render)(n.a.createElement(N.a,{bsStyle:"danger"},"Verification faild !"),document.getElementById("FormError")),console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.uploadProfile=function(t){var a=new FormData;a.append("myImage",e.state.file),console.log("dataaa",a,e.state.file),F.a.ajax({type:"POST",url:"/user/profile",headers:{"x-auth":sessionStorage.getItem("_auth_user")},data:a,cache:!1,contentType:!1,processData:!1,success:function(e,a,r){e.length>0&&(1===e[0]?(document.getElementById("div-profile").style.visibility="hidden",this.getUser(sessionStorage.getItem("_auth_user"))):(t.target.disabled=!1,Object(i.render)(n.a.createElement(N.a,{bsStyle:"danger"},"Not updated. Try again !"),document.getElementById("ProfileError"))))}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,a,r){t.target.disabled=!1,Object(i.render)(n.a.createElement(N.a,{bsStyle:"danger"},"Connection error, try again !"),document.getElementById("ProfileError"))}.bind(Object(R.a)(Object(R.a)(e)))})},e.confirm_ride_cancelled=function(){F.a.ajax({type:"POST",url:"/user/confirmDriverRideCancelled",headers:{"x-auth":sessionStorage.getItem("_auth_user")},data:JSON.stringify({status:777}),contentType:"application/json",success:function(t){t&&(document.getElementById("driver-cancel-ride").style.visibility="hidden",e.resetRide())},error:function(e,t,a){console.error("ride completed error",a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.state={current_latlng:{lat:0,lng:0},last_current_latlng:{lat:0,lng:0},isLogedIn:!1,pickup_flag:"off",dropoff_flag:"off",pickup_location:"Select your pickup location",pickup_latlng:{lat:0,lng:0},dropoff_latlng:{lat:0,lng:0},currentLatLng:{lat:0,lng:0},_driverCurrentLocation:{lat:0,lng:0},user:{firstName:"",middleName:"",email:"",mobile:"",profile:"",hasProfile:"",verified:"",status:""},profile_pic:"",imagePreviewUrl:"/assets/awet-rider-m.png",file:"",varificationCode:"",first_time_flag:!1,route_price:0,route_distance:0,route_time:0,route_time_string:0,isRouteFound:!1,map:"",markerGroup:"",carMarkerGroup:"",locationGroup:"",list:[],currentDrivers:[],pickupText:"",dropoffText:"",locationFoundFlag:!1,statusFlag:!1,timerWait:"",_driverImage:"",_driverCarImage:"",_driverName:"",_driverPlateNo:"",_driverMobile:"",_driverCarModel:"",rideCompleteFlag:!1,_nearest_driver_token:"",_nearest_driver_distance:0,_nearest_driver_eta:0,_nearest_driver_available:!1,_nearest_driver_latlng:{lat:0,lng:0},_signInFlag:!1,_fire_driver_eta_flag:!1,errors:[]},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getUser(sessionStorage.getItem("_auth_user"));var t=v.a.map("mapid");t.locate({setView:!0,maxZoom:17}),this.setState({map:t}),v.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(t),this.setState({markerGroup:(new v.a.LayerGroup).addTo(t),locationGroup:(new v.a.LayerGroup).addTo(t),carMarkerGroup:(new v.a.LayerGroup).addTo(t)}),this.getDrivers(t),t.on("locationfound",function(a){var r=e.state.locationGroup;r.clearLayers(),e.setState({current_latlng:a.latlng});var n=a.accuracy/1024;n=n.toFixed(2),v.a.circle(a.latlng,n).addTo(r),t.setView(a.latlng,15),e.setState({currentLatLng:a.latlng})}),t.on("locationerror",function(e){console.log("location error",e.message)}),t.on("click",function(t){var a=e.state.markerGroup;if(e.setState({first_time_flag:!1}),"off"===e.state.pickup_flag&&(v.a.marker(t.latlng,{icon:J}).addTo(a).bindPopup("<div class='popup-title'> Your pickup </div><div class='popup-content'> driver will come here.</div>"),e.setState({pickup_flag:"on",pickup_latlng:t.latlng,first_time_flag:!0}),e.getNearestDrivers(t.latlng)),"off"===e.state.dropoff_flag&&"on"===e.state.pickup_flag&&!1===e.state.first_time_flag&&(v.a.marker(t.latlng,{icon:Y}).addTo(a).bindPopup("<div class='popup-title'> Your dropoff </div><div class='popup-content'> ride ends here.</div>"),e.setState({dropoff_flag:"on",dropoff_latlng:t.latlng})),"on"===e.state.dropoff_flag&&"on"===e.state.pickup_flag&!1===e.state.isRouteFound){var r=e.state.pickup_latlng,n=e.state.dropoff_latlng;document.getElementById("div-intro").style.visibility="hidden",e.findRoute(r,n)}"on"===e.state.pickup_flag&&clearInterval(e.timerUserLocation)}),this.timerRideStatus=setInterval(this.checkRideStatus,7e3),this.timerUserLocation=setInterval(this.userCurrentLocation,1e4)}},{key:"componentDidUpdate",value:function(){}},{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return this.state._signInFlag?n.a.createElement(T.a,{to:"/user/login"}):n.a.createElement("div",null,n.a.createElement("div",{className:"user-info",id:"user-info"},n.a.createElement(x.a,{color:"teal"},n.a.createElement(x.a.Content,null,!0===this.state.user.hasProfile?n.a.createElement(P.a,{floated:"right",size:"mini",src:"/assets/profile/user/"+this.state.user.profile,circular:!0}):n.a.createElement(P.a,{floated:"right",size:"mini",src:"/assets/awet-rider-m.png"}),n.a.createElement(x.a.Header,null,!0===this.state.isLogedIn?"hi "+this.state.user.firstName:"hi rider!"),n.a.createElement(x.a.Meta,null,!0===this.state.isLogedIn?n.a.createElement(_.a,{as:f.a,to:"/user/login",basic:!0,pointing:!0,color:"green"},"LOGOUT"):n.a.createElement(_.a,{as:f.a,to:"/user/login",basic:!0,pointing:!0,color:"blue"},"LOGIN"))))),!1===this.state.user.verified?n.a.createElement("div",{className:"account-verify",id:"account-verfiy"},n.a.createElement("form",null,n.a.createElement(N.a,{positive:!0},n.a.createElement(N.a.Header,null,"Final step! Varify your mobile!"),n.a.createElement("p",null,"If the mobile number ",n.a.createElement("strong",null,this.state.user.mobile)," is yours. Enter the text message sent to your mobile and click varify."),n.a.createElement("p",null,n.a.createElement(b.a,{centered:!0},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(L.a,null,n.a.createElement("input",{name:"varificationCode",type:"text",value:this.state.varificationCode,placeholder:"XXXXX",onChange:function(t){return e.change(t)}}))),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(y.a,{color:"teal",size:"large",onClick:function(t){return e.onVarify(t)}},"VARIFY")),n.a.createElement("div",{className:"FormError",id:"FormError"}))))))):"",n.a.createElement("div",{className:"div-intro",id:"div-intro"},n.a.createElement(b.a,{fluid:!0},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,Object(I.a)({xs:12,sm:12},"sm",12),"Start by clicking your pickup and dropoff from the map.")))),!0===this.state.user.verified&&!1===this.state.user.hasProfile?n.a.createElement("div",{className:"div-profile",id:"div-profile"},n.a.createElement(b.a,null,n.a.createElement(N.a,{info:!0},n.a.createElement(N.a.Header,null,"Finally, Profile picture !"),n.a.createElement("p",null,"Helps to identify who you are."),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,null,n.a.createElement(L.a,null,n.a.createElement("input",{title:" ",className:"file1",name:"profile_pic",type:"file",onChange:function(t){return e._onChange_profile(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,null,n.a.createElement(P.a,{src:this.state.imagePreviewUrl,width:"35px",circular:!0}))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,null,n.a.createElement(y.a,{fluid:!0,color:"teal",onClick:function(t){return e.onProfileUpload(t)},disabled:!1},"Upload Image"))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,null,n.a.createElement("div",{className:"ProfileError",id:"ProfileError"})))))):"",n.a.createElement("div",{className:"div-notification-1",id:"div-notification-1"}),n.a.createElement("div",{className:"driver-cancel-ride",id:"driver-cancel-ride"},n.a.createElement("strong",null,"Cancelled ! ")," driver cancelled your ride.",n.a.createElement("p",null,n.a.createElement(b.a,{fluid:!0},n.a.createElement(b.a.Row,{className:"rowPaddingSm"},n.a.createElement(b.a.Column,{xs:12,sm:12,md:12},n.a.createElement(y.a,{onClick:function(t){return e.confirm_ride_cancelled(t)},bsSize:"small",block:!0},"OK")))))),n.a.createElement("div",{className:"ride-price-dashboard",id:"ride-price-dashboard"},n.a.createElement("div",null,n.a.createElement(x.a,{color:"teal"},n.a.createElement(x.a.Content,null,n.a.createElement(x.a.Description,null,n.a.createElement(b.a,{columns:3,divided:!0},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,null,n.a.createElement("h3",null,this.state.route_price+" birr")),n.a.createElement(b.a.Column,null,n.a.createElement("h3",null,this.state.route_distance+" km")),n.a.createElement(b.a.Column,null,n.a.createElement("h3",null,this.state.route_time_string," ")))))),n.a.createElement(x.a.Content,{extra:!0},n.a.createElement("div",{className:"ui two buttons"},n.a.createElement(y.a,{color:"green",onClick:function(t){return e.rideRequest(e.state.pickup_latlng,t)}},"REQUEST"),n.a.createElement(y.a,{basic:!0,color:"red",onClick:function(t){return e.cancelRide(t)}},"CANCEL")))),this.state._nearest_driver_eta)),n.a.createElement("div",{className:"ride-request-dashboard shake-ride-request",id:"ride-request-dashboard"},"Connecting nearest drivers ",n.a.createElement("br",null),"wait !"),n.a.createElement("div",{className:"ride-route-status",id:"ride-route-status"}),n.a.createElement("div",{className:"ride-route-try",id:"ride-route-try"},n.a.createElement("strong",null,"Oh! ")," No connection. Try again.",n.a.createElement("p",null,n.a.createElement(b.a,{fluid:!0},n.a.createElement(b.a.Row,{className:"rowPaddingSm"},n.a.createElement(b.a.Column,{xs:6,sm:6,md:6},n.a.createElement(y.a,{onClick:function(t){return e.findRoute(e.state.pickup_latlng,e.state.dropoff_latlng,t)},bsStyle:"warning",bsSize:"small",block:!0},"TRY AGAIN")),n.a.createElement(b.a.Column,{xs:6,sm:6,md:6},n.a.createElement(y.a,{onClick:function(t){return e.resetRide(t)},bsSize:"small",block:!0},"CANCEL")))))),n.a.createElement("div",{className:"u-driver-dashboard shake-ride-to-pickup",id:"u-driver-dashboard"},n.a.createElement("div",{className:"notify-rider",id:"notify-rider"}," Get ready ! driver coming."),n.a.createElement(b.a,{columns:3},n.a.createElement(b.a.Row,{className:"row_xs"},n.a.createElement(b.a.Column,{mobile:5,tablet:5,computer:6},n.a.createElement(P.a,{src:this.state._driverImage,height:45,circular:!0})),n.a.createElement(b.a.Column,Object(I.a)({mobile:5,tablet:5,computer:6,textAlign:"center"},"textAlign","center"),n.a.createElement(P.a,{src:this.state._driverCarImage,height:45,circular:!0})),n.a.createElement(b.a.Column,{mobile:5,tablet:5,computer:6,textAlign:"center"},this.state._driverCarModel," ",this.state._driverPlateNo)),n.a.createElement(b.a.Row,{className:"row_xs"},n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},this.state._driverName),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},this.state._driverMobile)))),n.a.createElement("div",{className:"u-driver-dashboard-2 shake-ride-to-pickup",id:"u-driver-dashboard-2"},n.a.createElement("div",{className:"notify-rider_2",id:"notify-rider_2"}," Ride inprogress"),n.a.createElement(b.a,{columns:3},n.a.createElement(b.a.Row,{className:"row_xs"},n.a.createElement(b.a.Column,Object(I.a)({mobile:5,tablet:5,computer:6,textAlign:"center"},"textAlign","center"),n.a.createElement(P.a,{src:this.state._driverImage,height:45,circular:!0})),n.a.createElement(b.a.Column,Object(I.a)({mobile:5,tablet:5,computer:6,textAlign:"center"},"textAlign","center"),n.a.createElement(P.a,{src:this.state._driverCarImage,height:45,circular:!0})),n.a.createElement(b.a.Column,Object(I.a)({mobile:5,tablet:5,computer:6,textAlign:"center"},"textAlign","center"),this.state._driverCarModel," ",this.state._driverPlateNo)),n.a.createElement(b.a.Row,{className:"row_xs"},n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},this.state._driverName),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},this.state._driverMobile)))),n.a.createElement("div",{className:"mapid",id:"mapid"}))}}]),t}(r.Component),X=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={pickupAdress:"Lord my God you have plan in my life",pickup_latlng:{lat:0,lng:0}},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(W,{pickupAdress:this.state.pickup_latlng}))}}]),t}(r.Component),Z=a(419),K=a(584),Q=a(585),$=a(586),ee=(a(537),a(538),a(266)),te=a.n(ee)()("http://localhost:5000"),ae=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).rideRequest=function(t){var a={user_id:"7141",driver_id:"0",pickup_latlng:"POINT(".concat(e.state.pickup_latlng.lat," ").concat(e.state.pickup_latlng.lng,")"),dropoff_latlng:"POINT(".concat(e.state.dropoff_latlng.lat," ").concat(e.state.dropoff_latlng.lng,")"),route_distance:e.state.route_distance,route_time:e.state.route_time,route_price:e.state.route_price,status:1};F.a.ajax({type:"POST",url:"/ride/rideRequest",data:JSON.stringify(a),contentType:"application/json",success:function(e,t,a){console.log("Nearest driver",e),document.getElementById("div-request").style.visibility="visible",this.setState({driver:e}),te.emit("request_driver",{msg:"test"})}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.findRoute=function(t,a){var r=e.state.map;v.a.Routing.control({waypoints:[v.a.latLng(t),v.a.latLng(a)]}).on("routesfound",e.routeFound).addTo(r)},e.routeFound=function(t){var a=t.routes,r=a[0].summary.totalDistance,n=a[0].summary.totalTime;r=Number.parseFloat(r/1e3).toFixed(2);var i=function(e){var t=e/3600,a=Math.floor(t),r=60*(t-a),n=Math.round(r);return(a>0?a+" hr":"")+(n>0?n+" min":"")}(Number.parseInt(n));e.setState({route_distance:Number.parseFloat(r).toFixed(2),route_price:o,route_time:n,isRouteFound:!0});var o=Number.parseFloat(19*r).toFixed(2);document.getElementById("ride_price").innerHTML=o+" Birr",document.getElementById("distance").innerHTML=r+" km",document.getElementById("ride_time").innerHTML=i},e.NearestDriverComponent=function(e){var t=e.driver;return n.a.createElement("div",null,n.a.createElement(Z.a,{fluid:!0},n.a.createElement(K.a,null,n.a.createElement(Q.a,{xs:6,md:6},n.a.createElement(w.a,{src:t.car_pic,height:45,circle:!0})),n.a.createElement(Q.a,{xs:6,md:6},n.a.createElement(w.a,{src:t.driver_pic,height:45,circle:!0}))),n.a.createElement(K.a,null,n.a.createElement(Q.a,{xs:6,md:6},t.model),n.a.createElement(Q.a,{xs:6,md:6},t.driver_name)),n.a.createElement(K.a,null,n.a.createElement(Q.a,{xs:6,md:6},t.plate),n.a.createElement(Q.a,{xs:6,md:6},t.driver_phone))))},e.state={dropoff_flag:!1,pickup_flag:!0,dropoff_location:"Select your pickup location",dropoff_latlng:{lat:9.0092,lng:38.7545},pickup_latlng:{lat:9.0092,lng:38.7645},route_price:0,route_distance:0,route_time:0,isRouteFound:!1,map:"",markersLayer:"",driver:{id:"",driver_name:"",driver_phone:"",model:"",plate:"",car_pic:"",driver_pic:""},socket_data:""},e.rideRequest=e.rideRequest.bind(Object(R.a)(Object(R.a)(e))),e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=v.a.map("mapid").setView([9.0092,38.7645],16);this.setState({map:e}),v.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(e);var t=(new v.a.LayerGroup).addTo(e);this.setState({markersLayer:t}),this.setState({pickup_latlng:JSON.parse(sessionStorage.getItem("session_pickup"))})}},{key:"componentDidUpdate",value:function(){var e,t=this,a=this.state.map,r=this.state.markersLayer;if(a.on("click",function(a){A.reverseGeocode({lat:a.latlng.lat,lon:a.latlng.lng,addressdetails:!0}).then(function(n){r.clearLayers(),e=v.a.marker(a.latlng).addTo(r).bindPopup("<div class='popup-title'> Your dropoff location is </div><div class='popup-content'>"+n.display_name+"</div>").openPopup(),r.addLayer(e),t.setState({dropoff_location:n.display_name,dropoff_latlng:a.latlng,dropoff_flag:!0})}).catch(function(e){console.error(e)})}),this.state.dropoff_flag&&this.state.pickup_flag&!1===this.state.isRouteFound){var n=this.state.pickup_latlng,i=this.state.dropoff_latlng;this.findRoute(n,i)}}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("div",{className:"mapid",id:"mapid"}),n.a.createElement("div",{className:"div-request",id:"div-request"},n.a.createElement(this.NearestDriverComponent,{driver:this.state.driver})),n.a.createElement("div",{className:"div-ride-price"},n.a.createElement("div",null,n.a.createElement(Z.a,{fluid:!0},n.a.createElement(K.a,null,n.a.createElement(Q.a,{xs:4,md:4},"Price ",n.a.createElement($.a,null,n.a.createElement("div",{id:"ride_price"}))),n.a.createElement(Q.a,{xs:4,md:4},"Distance ",n.a.createElement($.a,null,n.a.createElement("div",{id:"distance"}))),n.a.createElement(Q.a,{xs:4,md:4},"Time ",n.a.createElement($.a,null,n.a.createElement("div",{id:"ride_time"})))))),n.a.createElement("div",{id:"div-process",className:"div-process"},n.a.createElement("div",{className:"div-pickup-btn-box"},n.a.createElement(k.a,{onClick:function(t){return e.rideRequest(e.state.pickup_latlng,t)},bsStyle:"success",bsSize:"small"},"Request Driver")))))}}]),t}(r.Component),re=(r.Component,a(587)),ne=a(588),ie=a(593),oe=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this)))._onchange=function(t){e.setState(Object(I.a)({},t.target.name,t.target.value))},e.validateReason=function(){var t=[];return 0===e.state._reason.length&&t.push("Select reason for cancel."),t},e._onsubmit=function(t){console.log("reason",e.state._reason),t.target.disabled=!0,t.preventDefault();var a=e.validateReason();if(a.length>0){t.target.disabled=!1;var r=e.getErrorList(a);Object(i.render)(n.a.createElement("div",{className:"div_error"},r),document.getElementById("div-error-reason"))}else{var o={reason:e.state._reason,ride_id:e.props.ride_id};e.submit_reason(o,t),e.setState({_show_confirm:!0,_show_reason:!1,_reason:"",errors:[]})}},e.submit_reason=function(t,a){F.a.ajax({type:"POST",url:"/driver/ride/cancel",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){console.log("so what comes",e),e.length>0&&1===e[0]&&(Object(i.render)("",document.getElementById("driver-ride-cancel")),this.props.rideCompletedAction())}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){Object(i.render)(n.a.createElement("div",{className:"div-error"},"connection error, try again"),document.getElementById("div-error-reason"))}.bind(Object(R.a)(Object(R.a)(e)))})},e._yes=function(t){e.setState({_show_confirm:!1,_show_reason:!0})},e._no=function(e){Object(i.render)("",document.getElementById("driver-ride-cancel"))},e.state={_show_confirm:!0,_show_reason:!1,_reason:""},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,!0===this.state._show_confirm?n.a.createElement("div",{className:"div-confirm",id:"div-confirm"},n.a.createElement("strong",null,"Are you sure ! ")," . you want to cancel ?",n.a.createElement("p",null,n.a.createElement(Z.a,{fluid:!0},n.a.createElement(K.a,{className:"rowPaddingSm"},n.a.createElement(Q.a,{xs:6,sm:6,md:6},n.a.createElement(k.a,{onClick:function(t){return e._no(t)},bsSize:"small",block:!0},"NO")),n.a.createElement(Q.a,{xs:6,sm:6,md:6},n.a.createElement(k.a,{onClick:function(t){return e._yes(t)},bsStyle:"danger",bsSize:"small",block:!0},"YES")))))):"",!0===this.state._show_reason?n.a.createElement("div",null,n.a.createElement("div",{className:"div-reason",id:"div-reason"},n.a.createElement("p",null,n.a.createElement("form",null,n.a.createElement(Z.a,{fluid:!0},n.a.createElement(K.a,{className:"rowPaddingSm"},n.a.createElement(Q.a,{xs:12,sm:12,md:12},n.a.createElement(re.a,null,n.a.createElement(ne.a,null,"SELECT REASON"),n.a.createElement(ie.a,{name:"_reason",componentClass:"select",placeholder:"select",onChange:function(t){return e._onchange(t)}},n.a.createElement("option",{value:""},"select"),n.a.createElement("option",{value:"MY-CAR-NOT-WORKING"},"MY CAR NOT WORKING"),n.a.createElement("option",{value:"PASSANGE-NOT-FOUND"},"PASSANGE NOT FOUND"),n.a.createElement("option",{value:"HIGHT-TRAFIC"},"HIGHT TRAFIC"),n.a.createElement("option",{value:"OTHER"},"OTHER"))))),n.a.createElement(K.a,{className:"rowPaddingSm"},n.a.createElement(Q.a,{xs:6,sm:6,md:6},n.a.createElement(k.a,{onClick:function(t){return e._onsubmit(t)},bsStyle:"danger",bsSize:"small",block:!0},"SUBMIT")),n.a.createElement(Q.a,{xs:6,sm:6,md:6},n.a.createElement(k.a,{onClick:function(t){return e._no(t)},bsSize:"small",bsStyle:"success",block:!0},"BACK"))),n.a.createElement(K.a,null,n.a.createElement(Q.a,{xs:12,sm:12,md:12},n.a.createElement("div",{className:"div-error-reason",id:"div-error-reason"})))))))):"")}}]),t}(r.Component),le=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this)))._yes=function(t){e.setState({_show_confirm:!1,_show_reason:!0})},e._no=function(e){Object(i.render)("",document.getElementById("driver-ride-cancel"))},e.confirm_missed_ride=function(t){t.target.disabled=!0,F.a.ajax({type:"POST",url:"/driver/ready_for_work",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:JSON.stringify({}),contentType:"application/json",success:function(e){1===e[0]?(document.getElementById("missed-ride").style.visibility="hidden",Object(i.render)("",document.getElementById("missed-ride"))):Object(i.render)("error, not updated",document.getElementById("missed-confirm-error"))},error:function(e,t,a){Object(i.render)("error, try again",document.getElementById("missed-confirm-error"))}.bind(Object(R.a)(Object(R.a)(e)))})},e.state={_show_confirm:!0,_show_reason:!1,_reason:""},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(N.a,{success:!0},n.a.createElement(N.a.Header,null,"You Missed a ride !"),n.a.createElement("p",null,"This will affect customer and our work. Please remind repeated missed ride will lead to closing your account."),n.a.createElement("p",null,n.a.createElement("h3",null,"Are you ready to work now ?")),n.a.createElement("p",null,n.a.createElement(b.a,{columns:2},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(y.a,{color:"green",onClick:function(t){return e.confirm_missed_ride(t)},fluid:!0},"YES")),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(y.a,{color:"grey",onClick:function(t){return e.onVarify(t)},fluid:!0},"NO"))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement("div",{className:"div-error",id:"missed-confirm-error"})))))))}}]),t}(r.Component),se=(r.Component,a(567),a(103)),ce=a(219),de=a(568),ue=de.Howl,me=(de.Howler,new ue({src:["/assets/sounds/awet-ride.mp3","/assets/sounds/awet-ride.ogg","/assets/sounds/awet-ride.m4r"],autoplay:!0,loop:!0,volume:0})),pe=v.a.icon({iconUrl:"/assets/awet-rider-m.png",shadowUrl:"",iconSize:[50,50],shadowSize:[50,64],iconAnchor:[12,50],shadowAnchor:[4,62],popupAnchor:[-1,-45]}),ge=v.a.icon({iconUrl:"/assets/awet-ride-dropoff-marker.png",shadowUrl:"",iconSize:[80,80],shadowSize:[50,64],iconAnchor:[0,75],shadowAnchor:[4,62],popupAnchor:[-3,-75]}),he=v.a.icon({iconUrl:"/assets/awet-ride-marker-1.png",shadowUrl:"",iconSize:[80,49],shadowSize:[50,64],iconAnchor:[20,20],shadowAnchor:[4,62],popupAnchor:[20,-5]}),ve=[{key:"1",text:"VITZ",value:"VITZ"},{key:"2",text:"COROLLA",value:"COROLLA"}],fe=[{key:"1",text:"2019",value:"2019"},{key:"2",text:"2018",value:"2015"}],be=[{key:"1",text:"01",value:"01"},{key:"2",text:"03",value:"03"}],Ee=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).getDriver=function(t){F.a.ajax({type:"GET",url:"/driver/get",headers:{"x-auth":t},contentType:"application/json",success:function(e,t,a){console.log("driver data is ",e),this.setState({driver:e,isLogedIn:!0})}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.log("getdriver",a.toString()),console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.driverCurrentLocation=function(){new Promise(function(t,a){e.state.map.locate(),t(!0)}).then(function(t){if(!M.a.isEqual(e.state.current_latlng,e.state.last_current_latlng)){console.log("current latlng",e.state.current_latlng,e.state.last_current_latlng);var a=sessionStorage.getItem("_auth_driver"),r={_latlng:"POINT(".concat(e.state.current_latlng.lat," ").concat(e.state.current_latlng.lng,")")};F.a.ajax({type:"POST",url:"/driver/updateLocation",headers:{"x-auth":a},data:JSON.stringify(r),contentType:"application/json",success:function(e,t,a){console.log("drive location update",e)}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))}),e.setState({last_current_latlng:e.state.current_latlng})}})},e.driverRidesInfo=function(){F.a.ajax({type:"POST",url:"/driver/getRidesInfo",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:JSON.stringify({status:777}),contentType:"application/json",success:function(t){t.length>0?(console.log("driver info",t),e.setState({driverName:t[0].driver.firstName,driverMobile:t[0].driver.mobile,amount:t[0].amount,charge:t[0].charge,total_rides:t[0].total_rides})):(console.log("driver has no payment",e.state.driver),e.setState({driverName:e.state.driver.firstName,driverMobile:e.state.driver.mobile,amount:0,charge:0,total_rides:0}))},error:function(e,t,a){console.error("ride completed error",a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.checkForRide=function(){F.a.ajax({type:"POST",url:"/ride/check_ride_driver",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:JSON.stringify({status:1}),contentType:"application/json"}).done(function(e){console.log("done done",e)}).fail(function(e,t,a){console.log("Error",a)}).always(function(t){(console.log("always ",t),M.a.isNull(t)||M.a.isUndefined(t.driver))||(1===t.status?new Promise(function(t,a){e.setState({_ride_alert_first_time_flag:!0}),t(!0)}).then(function(){e.ride_alert(t)}):7===t.status?(e.acceptRideAction(t),clearInterval(e.timerCheckForRide)):77===t.status?(e.setState({ridePrice:t.route_price,rideDistance:t.route_distance,rideTime:t.route_time,rideUser:t.user.firstName+" "+t.user.middleName,userMobile:t.user.mobile,userPic:"/assets/profile/user/"+t.user.profile}),e.showDropOffLocation(e.state.pickup_latlng,e.state.dropoff_latlng),clearInterval(e.timerCheckForRide)):2===t.driver.status&&(me.volume(0,e.soundAccept),document.getElementById("check-ride-dashboard").style.visibility="hidden",document.getElementById("missed-ride").style.visibility="visible",Object(i.render)(n.a.createElement(le,null),document.getElementById("missed-ride"))))})},e.ride_alert=function(t){me.volume(.7,e.soundAccept),e.setState({ridePrice:t.route_price,rideDistance:t.route_distance,rideTime:t.route_time,rideUser:t.user.firstName+" "+t.user.middleName,userMobile:t.user.mobile,userPic:"/assets/profile/user/"+t.user.profile}),document.getElementById("check-ride-dashboard").style.visibility="visible",e.showPickUpLocation(t.pickup_latlng.coordinates,e.state.current_latlng),clearInterval(e.timerUserLocation)},e.acceptRide=function(){console.log("accept called");F.a.ajax({type:"POST",url:"/ride/accepted",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:JSON.stringify({status:7}),contentType:"application/json",success:function(e,t,a){alert("Jesus"),console.log("jsesu",e),e&&this.acceptRideAction(e)}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.error("accept test case error",a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.acceptRideAction=function(t){e.setState({ridePrice:t.route_price,rideDistance:t.route_distance,rideTime:t.route_time,rideUser:t.user.firstName+" "+t.user.middleName,userMobile:t.user.mobile,userPic:"/assets/profile/user/"+t.user.profile,ride_id:t.id}),me.volume(0,e.soundAccept),new Promise(function(a,r){document.getElementById("check-ride-dashboard").style.visibility="hidden",document.getElementById("driver-dashboard").style.visibility="hidden",document.getElementById("driver-pax-action").style.visibility="visible",me.volume(0,e.soundAccept),e.setState({pickup_latlng:t.pickup_latlng.coordinates,dropoff_latlng:t.dropoff_latlng.coordinates,stopMapViewFlag:!0}),a()}).then(function(){e.showPickUpLocation(t.pickup_latlng.coordinates),e.timerDriverLocation=setInterval(e.driverCurrentLocation,1e4)})},e.rideCompleted=function(){F.a.ajax({type:"POST",url:"/ride/completed",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:JSON.stringify({status:777}),contentType:"application/json",success:function(t){console.log("payment returned",t),t&&e.rideCompletedAction(t)},error:function(e,t,a){console.error("ride completed error",a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.rideCompletedAction=function(t){new Promise(function(t,a){document.getElementById("driver-pax-action").style.visibility="hidden",document.getElementById("driver-pax-end-action").style.visibility="hidden",document.getElementById("check-ride-dashboard").style.visibility="hidden";e.state.map;e.state.markerGroup.clearLayers(),e.setState({pickupRoutFlag:!1,stopMapViewFlag:!1}),t(!0)}).then(function(){e.driverRidesInfo(),e.timerCheckForRide=setInterval(e.checkForRide,5e3),document.getElementById("driver-dashboard").style.visibility="visible"})},e.paxFound=function(){F.a.ajax({type:"POST",url:"/ride/paxFound",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:JSON.stringify({status:77}),contentType:"application/json",success:function(t){t&&e.showDropOffLocation(e.state.pickup_latlng,e.state.dropoff_latlng)},error:function(e,t,a){console.error("ride completed error",a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.showPickUpLocation=function(t,a){var r=e.state.map,n=e.state.markerGroup;v.a.marker(t,{icon:pe}).addTo(n).bindPopup("Pick passenger here.").openPopup(),r.setView(t,15),e.showPickUpRoute(a,t)},e.showPickUpRoute=function(t,a){if(!e.state.pickupRoutFlag){var r=e.state.map;e.routeControl&&(r.removeControl(e.routeControl),e.routeControl=null),console.log("show pickup route",t),e.routeControl=v.a.Routing.control({waypoints:[v.a.latLng(t),v.a.latLng(a)],routeWhileDragging:!1,addWaypoints:!1,show:!1,createMarker:function(){return null},router:v.a.Routing.osrmv1({serviceUrl:ce.ROUTING_SERVICE})}).on("routesfound",e.routeFound).addTo(r)}},e.routeFound=function(){e.setState({pickupRoutFlag:!0})},e.showDropOffLocation=function(t,a){new Promise(function(e,t){document.getElementById("driver-pax-action").style.visibility="hidden",document.getElementById("driver-pax-end-action").style.visibility="visible",e(!0)}).then(function(){var r=e.state.map,n=e.state.markerGroup;v.a.marker(t,{icon:pe}).addTo(n).bindPopup("Pickup location.").openPopup(),v.a.marker(a,{icon:ge}).addTo(n).bindPopup("Final dropoff location.").openPopup(),r.setView(a,15),e.showDropOffRoute(t,a)})},e.showDropOffRoute=function(t,a){var r=e.state.map;r.removeControl(e.routeControl),e.routeControl=v.a.Routing.control({waypoints:[v.a.latLng(t),v.a.latLng(a)],routeWhileDragging:!1,addWaypoints:!1,show:!1,createMarker:function(){return null},router:v.a.Routing.osrmv1({serviceUrl:ce.ROUTING_SERVICE})}).on("routesfound",e.routeFound).addTo(r)},e.timeConvert=function(e){var t=e/3600,a=Math.floor(t),r=60*(t-a),n=Math.round(r);return(a>0?a+" hr":"")+(n>0?n+" min":"")},e.validateVarification=function(){var t=[];return 0===e.state.varificationCode.length?t.push("Varification field is empty."):!1===se.isLength(e.state.varificationCode,{min:5})?t.push("Code must not be less than 5 characters"):!1===se.isLength(e.state.varificationCode,{max:5})?t.push("Code is greater than 5 characters"):!1===se.isNumeric(e.state.varificationCode,{no_symbols:!0})&&t.push("Varification number is not valid"),t},e.validateCarRegistration=function(){var t=[];return 0===e.state.model.length?t.push("Select model."):0===e.state.model_year.length&&t.push("Select year"),0===e.state.code.length&&t.push("Select plate code"),0===e.state.plate_no.length?t.push("Plate Number is empty."):!1===se.isAlphanumeric(e.state.plate_no)?t.push("Plate Number is not valid."):!1===se.isLength(e.state.plate_no,{min:5,max:6})&&t.push("Plate Number is not correct"),t},e.change=function(t){e.setState(Object(I.a)({},t.target.name,t.target.value))},e.onVarify=function(t){t.preventDefault();var a=e.validateVarification();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(N.a,{negative:!0},r),document.getElementById("FormError"))}else{var o={varification_code:e.state.varificationCode};e.varify(o),e.setState({varificationCode:"",errors:[]})}},e.varify=function(t){F.a.ajax({type:"POST",url:"/driver/mobile_verification",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){e&&(Object(i.render)(n.a.createElement(V,null),document.getElementById("account-verfiy")),this.getDriver(sessionStorage.getItem("_auth_driver")))}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){Object(i.render)(n.a.createElement(N.a,{negative:!0},"Verification faild !"),document.getElementById("FormError")),console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e.onValidateCarRegister=function(t){t.preventDefault();var a=e.validateCarRegistration();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(N.a,{negative:!0},r),document.getElementById("err_car_register"))}else{var o={model:e.state.model,model_year:e.state.model_year,code:e.state.code,plate_no:e.state.plate_no};e.validateCarRegister(o),e.setState({model:"",model_year:"",code:"",plate_no:"",errors:[]})}},e.validateCarRegister=function(t){F.a.ajax({type:"POST",url:"/car/register",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){e&&(Object(i.render)(n.a.createElement(V,null),document.getElementById("register-car")),this.getDriver(sessionStorage.getItem("_auth_driver")))}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){Object(i.render)(n.a.createElement(N.a,{negative:!0},"Car registration faild !"),document.getElementById("err_car_register")),console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e._onChange_profile=function(t){t.preventDefault();var a=new FileReader,r=t.target.files[0];a.onloadend=function(){e.setState({file:r,imagePreviewUrl:a.result})},a.readAsDataURL(r)},e.validateProfile=function(){console.log("file",e.state.file);var t=[];if(0===e.state.file.length&&t.push("Picture is empty. Browse first."),e.state.file.size>1024e3&&t.push("Selected Picture is very large"),e.state.file.size>0){var a=e.state.file.type.split("/").pop().toLowerCase();console.log("ttt",a),"jpeg"!=a&&"jpg"!=a&&"png"!=a&&"bmp"!=a&&"gif"!=a&&t.push("Please select a valid image file")}return t},e.onProfileUpload=function(t){t.target.disabled=!0,t.preventDefault();var a=e.validateProfile();if(a.length>0){t.target.disabled=!1;var r=e.getErrorList(a);Object(i.render)(n.a.createElement(N.a,{bsStyle:"danger"},r),document.getElementById("ProfileError"))}else e.uploadProfile(t),e.setState({file:"",imagePreviewUrl:"",errors:[]})},e.uploadProfile=function(t){var a=new FormData;a.append("myImage",e.state.file),console.log("dataaa",a,e.state.file),F.a.ajax({type:"POST",url:"/driver/profile",headers:{"x-auth":sessionStorage.getItem("_auth_driver")},data:a,cache:!1,contentType:!1,processData:!1,success:function(e,a,r){e.length>0&&(1===e[0]?(document.getElementById("div-profile").style.visibility="hidden",this.getDriver(sessionStorage.getItem("_auth_driver"))):(t.target.disabled=!1,Object(i.render)(n.a.createElement(N.a,{bsStyle:"danger"},"Not updated. Try again !"),document.getElementById("ProfileError"))))}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,a,r){t.target.disabled=!1,Object(i.render)(n.a.createElement(N.a,{bsStyle:"danger"},"Connection error, try again !"),document.getElementById("ProfileError"))}.bind(Object(R.a)(Object(R.a)(e)))})},e.cancelRide=function(t){Object(i.render)(n.a.createElement(oe,{ride_id:e.state.ride_id,rideCompletedAction:e.rideCompletedAction}),document.getElementById("driver-ride-cancel"))},e.onChangeModel=function(t,a){e.setState({model:a.value})},e.onChangeModelYear=function(t,a){e.setState({model_year:a.value})},e.onChangeCode=function(t,a){e.setState({code:a.value})},e.state={current_latlng:{lat:0,lng:0},last_current_latlng:{lat:0,lng:0},isLogedIn:!1,pickup_latlng:"",dropoff_latlng:"",driver_id:"",markerGroup:"",locationGroup:"",map:"",auth:!1,soundFlag:!1,driver:{firstName:"",middleName:"",email:"",mobile:"",gender:"",profile:"",hasProfile:"",verified:"",isCarRegistered:"",status:""},profile_pic:"",imagePreviewUrl:"/assets/awet-rider-m.png",file:"",varificationCode:"",ride_id:"",ridePrice:"",rideDistance:"",rideTime:"",rideUser:"",userMobile:"",userPic:"",driverName:"",driverMobile:"",amount:"",charge:"",total_rides:"",pickupRoutFlag:!1,locationFoundFlag:!1,stopMapViewFlag:!1,model:"",model_year:"",code:"",plate_no:""},e.checkForRide=e.checkForRide.bind(Object(R.a)(Object(R.a)(e))),e.getDriver=e.getDriver.bind(Object(R.a)(Object(R.a)(e))),e.driverCurrentLocation=e.driverCurrentLocation.bind(Object(R.a)(Object(R.a)(e))),e.acceptRide=e.acceptRide.bind(Object(R.a)(Object(R.a)(e))),e.rideCompleted=e.rideCompleted.bind(Object(R.a)(Object(R.a)(e))),e.showPickUpLocation=e.showPickUpLocation.bind(Object(R.a)(Object(R.a)(e))),e.showPickUpRoute=e.showPickUpRoute.bind(Object(R.a)(Object(R.a)(e))),e.showDropOffLocation=e.showDropOffLocation.bind(Object(R.a)(Object(R.a)(e))),e.showDropOffRoute=e.showDropOffRoute.bind(Object(R.a)(Object(R.a)(e))),e.timeConvert=e.timeConvert.bind(Object(R.a)(Object(R.a)(e))),e.driverRidesInfo=e.driverRidesInfo.bind(Object(R.a)(Object(R.a)(e))),e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getDriver(sessionStorage.getItem("_auth_driver")),this.setState({auth:sessionStorage.getItem("_auth_driver")}),this.driverRidesInfo();var t=v.a.map("mapid").setView([9.0092,38.7645],17);t.locate({setView:!0,maxZoom:17}),this.setState({map:t}),v.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(t),this.setState({markerGroup:(new v.a.LayerGroup).addTo(t),locationGroup:(new v.a.LayerGroup).addTo(t)}),this.timerCheckForRide=setInterval(this.checkForRide,5e3),this.timerDriverLocation=setInterval(this.driverCurrentLocation,1e4),t.on("locationfound",function(a){var r=e.state.locationGroup;r.clearLayers(),e.setState({current_latlng:a.latlng});var n=a.accuracy/1024;n=n.toFixed(2),v.a.marker(a.latlng,{icon:he}).addTo(r).bindPopup("You are "+n+" meters from this point").openPopup(),v.a.circle(a.latlng,n).addTo(r),t.setView(a.latlng,17)}),t.on("locationerror",function(e){console.log("location error",e.message)})}},{key:"componentDidUpdate",value:function(){}},{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("div",{className:"driver-dashboard",id:"driver-dashboard"},n.a.createElement(x.a,{color:"teal"},n.a.createElement(x.a.Content,null,!0===this.state.driver.hasProfile?n.a.createElement(P.a,{floated:"right",size:"mini",src:"/assets/profile/driver/"+this.state.driver.profile,circular:!0}):n.a.createElement(P.a,{floated:"right",size:"mini",src:"/assets/awet-rider-m.png"}),n.a.createElement(x.a.Header,null,!0===this.state.isLogedIn?"hi "+this.state.driver.firstName:"hi there!"),n.a.createElement(x.a.Meta,null,!0===this.state.isLogedIn?n.a.createElement(_.a,{as:f.a,to:"/driver/login",basic:!0,pointing:!0,color:"green"},"LOGOUT"):n.a.createElement(_.a,{as:f.a,to:"/driver/login",basic:!0,pointing:!0,color:"blue"},"LOGIN")),n.a.createElement(x.a.Description,null,n.a.createElement(b.a,{columns:2,centered:!0,divided:!0},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8,textAlign:"center"},"Birr ",n.a.createElement(_.a,{size:"large",color:"green",circular:!0},this.state.amount," ")),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8,textAlign:"center"},"Charge ",n.a.createElement(_.a,{size:"large",color:"yellow",circular:!0},this.state.charge))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8,textAlign:"center"},"Ride  ",n.a.createElement(_.a,{color:"teal",size:"large",circular:!0},this.state.total_rides)),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8,textAlign:"center"},n.a.createElement(_.a,{color:"olive"},"Status Working")))))))),!1===this.state.driver.isCarRegistered&&!0===this.state.driver.verified?n.a.createElement("div",{className:"register-car",id:"register-car"},n.a.createElement("form",null,n.a.createElement(N.a,null,n.a.createElement(N.a.Header,null,"Register your car !"),n.a.createElement("p",null,"Enter correct information.false information will lead to block your account."),n.a.createElement("p",null,n.a.createElement(b.a,{columns:2},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(L.a,null,n.a.createElement(L.a.Select,{name:"model",fluid:!0,label:"Model",options:ve,placeholder:"Model",onChange:this.onChangeModel}))),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(L.a,null,n.a.createElement(L.a.Select,{name:"model_year",fluid:!0,label:"Model Year",options:fe,placeholder:"Year",onChange:this.onChangeModelYear})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(L.a,null,n.a.createElement(L.a.Select,{name:"code",fluid:!0,label:"Plate Code",options:be,placeholder:"Code",onChange:this.onChangeCode}))),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(L.a,null,"Plate #",n.a.createElement("input",{name:"plate_no",type:"text",value:this.state.plate_no,placeholder:"Plate No.",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement(y.a,{color:"green",onClick:function(t){return e.onValidateCarRegister(t)},fluid:!0},"REGISTER"))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement("div",{className:"err_car_register",id:"err_car_register"})))))))):"",!1===this.state.driver.verified?n.a.createElement("div",{className:"account-verify",id:"account-verfiy"},n.a.createElement("form",null,n.a.createElement(N.a,{success:!0},n.a.createElement(N.a.Header,null,"Final step! Varify your mobile!"),n.a.createElement("p",null,"If the mobile number ",n.a.createElement("strong",null," ",this.state.driver.mobile)," is yours. Enter the text message sent to your mobile and click varify."),n.a.createElement("p",null,n.a.createElement(b.a,{columns:2},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(L.a,null,n.a.createElement("input",{name:"varificationCode",type:"text",value:this.state.varificationCode,placeholder:"XXXXX",onChange:function(t){return e.change(t)}}))),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},n.a.createElement(y.a,{color:"green",onClick:function(t){return e.onVarify(t)},fluid:!0},"VARIFY"))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement("div",{className:"FormError",id:"FormError"})))))))):"",!0===this.state.driver.verified&&!0===this.state.driver.isCarRegistered&&!1===this.state.driver.hasProfile?n.a.createElement("div",{className:"div-profile",id:"div-profile"},n.a.createElement(b.a,{columns:1},n.a.createElement(N.a,{info:!0},n.a.createElement(N.a.Header,null,"Finaly ! Profile picture."),n.a.createElement("p",null,"Helps to identify who you are."),n.a.createElement("p",null,n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement(P.a,{src:this.state.imagePreviewUrl,height:35,circle:!0,centered:!0}))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement(L.a,null,n.a.createElement("input",{title:" ",className:"file1",name:"profile_pic",type:"file",onChange:function(t){return e._onChange_profile(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement(y.a,{color:"green",onClick:function(t){return e.onProfileUpload(t)},disabled:!1,fluid:!0},"Upload Image"))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement("div",{className:"ProfileError",id:"ProfileError"}))))))):"",n.a.createElement("div",{id:"missed-ride",className:"missed-ride"}),n.a.createElement("div",{className:"check-ride-dashboard shake-ride-request",id:"check-ride-dashboard"},n.a.createElement(b.a,{columns:4,centered:!0},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},n.a.createElement(P.a,{src:this.state.userPic,height:40,circular:!0})),n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},n.a.createElement("h3",null,this.state.ridePrice),"Birr"),n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},n.a.createElement("h3",null,this.state.rideDistance),"km"),n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},n.a.createElement("h3",null,this.timeConvert(Number.parseInt(this.state.rideTime))," "))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement(y.a,{size:"huge",color:"green",onClick:function(t){return e.acceptRide()},bsSize:"large",fluid:!0},"ACCEPT RIDE"))))),n.a.createElement("div",{id:"driver-pax-action",className:"driver-pax-action shake-ride-to-pickup"},n.a.createElement(b.a,{columns:4},n.a.createElement(b.a.Row,{className:"row_sm"},n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},n.a.createElement(P.a,{src:this.state.userPic,height:40,circular:!0})),n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},this.state.ridePrice+" birr"),n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},this.state.rideDistance+" km"),n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},this.timeConvert(Number.parseInt(this.state.rideTime)))),n.a.createElement(b.a.Row,{className:"row_sm"},n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},this.state.rideUser),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},this.state.userMobile)),n.a.createElement(b.a.Row,{className:"row_sm"},n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement(y.a,{size:"medium",color:"green",onClick:function(t){return e.paxFound()},fluid:!0},"I FOUND THE PASSENGER"))),n.a.createElement(b.a.Row,{className:"row_sm"},n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement(y.a,{size:"mini",color:"red",onClick:function(t){return e.cancelRide()},fluid:!0},"CANCEL RIDE"))))),n.a.createElement("div",{id:"driver-pax-end-action",className:"driver-pax-end-action shake-finish-ride"},n.a.createElement(b.a,{columns:4},n.a.createElement(b.a.Row,{className:"row_sm"},n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},n.a.createElement(P.a,{src:this.state.userPic,height:40,circular:!0})),n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},this.state.ridePrice+" birr"),n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},this.state.rideDistance+" km"),n.a.createElement(b.a.Column,{mobile:4,tablet:4,computer:4,textAlign:"center"},this.timeConvert(Number.parseInt(this.state.rideTime)))),n.a.createElement(b.a.Row,{className:"row_sm"},n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},this.state.rideUser),n.a.createElement(b.a.Column,{mobile:8,tablet:8,computer:8},this.state.userMobile)),n.a.createElement(b.a.Row,{className:"row_sm"},n.a.createElement(b.a.Column,{mobile:16,tablet:16,computer:16},n.a.createElement(y.a,{color:"orange",size:"medium",onClick:function(t){return e.rideCompleted()},fluid:!0},"RIDE COMPLETED"))))),n.a.createElement("div",{className:"mapid",id:"mapid"}))}}]),t}(r.Component),ye=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={latlng:{lat:0,lng:0}},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return console.log("driver page"),n.a.createElement("div",null,n.a.createElement(Ee,null))}}]),t}(r.Component),_e=a(103),Oe=[{key:"m",text:"Male",value:"male"},{key:"f",text:"Female",value:"female"}],Ce=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).validateDriverApply=function(){var t=[];return 0===e.state.firstName.length?t.push("First name field is empty."):e.state.firstName.length<2?t.push("Your first name is very short."):!1===_e.isAlpha(e.state.firstName)&&t.push("First name needs to be alphabet"),0===e.state.middleName.length?t.push("Father name field is empty."):e.state.middleName.length<2?t.push("Father name is very short"):!1===_e.isAlpha(e.state.middleName)&&t.push("Father name needs to be alphabet"),!1===_e.isEmail(e.state.email)?t.push("Email address is not valid."):0===e.state.email.length&&t.push("Mobile field is empty."),0===e.state.mobile.length?t.push("Mobile field is empty"):!1===_e.isNumeric(e.state.mobile,{no_symbols:!0})?t.push("Mobile number is not valid"):!1===_e.isMobilePhone(e.state.mobile)?t.push("Mobile field is not correct"):e.state.mobile.length<10?t.push("Mobile number needs to be 10 digits"):e.state.mobile.length>10&&t.push("Mobile number needs to be 10 digits"),0===e.state.password.length?t.push("Password field is empty"):!1===_e.isLength(e.state.password,{min:6})?t.push("Password length must not be less than 6 characters"):!1===_e.isLength(e.state.password,{max:15})&&t.push("Password length very long"),0===e.state.gender.length&&t.push("Gender field is not selected"),t},e.change=function(t){e.setState(Object(I.a)({},t.target.name,t.target.value))},e.onChangeGender=function(t,a){e.setState({gender:a.value})},e.onDriverApply=function(t){t.preventDefault();var a=e.validateDriverApply();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(N.a,{negative:!0},r),document.getElementById("FormError"))}else{var o={firstName:e.state.firstName,middleName:e.state.middleName,email:e.state.email,mobile:e.state.mobile,password:e.state.password,re_password:e.state.re_password,gender:e.state.gender,plateNo:e.state.plateNo};e.driverApply(o),e.setState({firstName:"",middleName:"",email:"",mobile:"",password:"",re_password:"",gender:"",plateNo:"",errors:[]})}},e.driverApply=function(t){F.a.ajax({type:"POST",url:"/driver/apply",data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){sessionStorage.setItem("_auth_driver",e.token),this.setState({auth:e.token}),console.log("token",e.token),console.log("driver applied success",e)}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e._yes=function(t){e.setState({show_form:!0})},e.state={firstName:"",middleName:"",email:"",mobile:"",password:"",re_password:"",gender:"",plateNo:"",errors:[],auth:!1,show_form:!1},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return this.state.auth?n.a.createElement(T.a,{to:"/driver"}):n.a.createElement("div",null,!1===this.state.show_form?n.a.createElement("div",{className:"driverLoginBox"},n.a.createElement(b.a,{columns:1,centered:!0,stackable:!0},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(y.a,{color:"olive",size:"huge",onClick:function(t){return e._yes(t)},fluid:!0},"REGISTER TO DRIVE"))))):n.a.createElement("div",{className:"driverLoginBox"},n.a.createElement(b.a,{columns:1},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"First Name"),n.a.createElement("input",{name:"firstName",type:"text",value:this.state.firstName,placeholder:"First Name",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"Father Name"),n.a.createElement("input",{name:"middleName",type:"text",value:this.state.middleName,placeholder:"Father Name",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"Email"),n.a.createElement("input",{name:"email",type:"text",value:this.state.email,placeholder:"email address",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"Mobile"),n.a.createElement("input",{name:"mobile",type:"text",value:this.state.mobile,placeholder:"Mobile number",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"Password"),n.a.createElement("input",{name:"password",type:"password",value:this.state.password,placeholder:"Password",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement(L.a.Select,{name:"gender",fluid:!0,label:"Gender",options:Oe,placeholder:"Gender",onChange:this.onChangeGender})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,null,n.a.createElement(y.a,{color:"olive",size:"huge",onClick:function(t){return e.onDriverApply(t)},fluid:!0},"APPLY TO DRIVE"))))))}}]),t}(r.Component),we=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).validateDriverLogin=function(){var t=[];return 0===e.state.loginEmail.length&&t.push("Email field is empty."),0===e.state.loginPassword.length&&t.push("Password field is empty."),t},e.change=function(t){e.setState(Object(I.a)({},t.target.name,t.target.value))},e.onDriverLogin=function(t){t.preventDefault();var a=e.validateDriverLogin();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(N.a,{negative:!0},r),document.getElementById("FormError"))}else{var o={email:e.state.loginEmail,password:e.state.loginPassword};e.driverLogin(o),e.setState({loginEmail:"",loginPassword:"",errors:[]})}},e.driverLogin=function(t){console.log("test",t),F.a.ajax({type:"POST",url:"/driver/login",data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){sessionStorage.setItem("_auth_driver",e.token),this.setState({auth:e.token})}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.log("errrrr",a.toString()),"Unauthorized"===a.toString()?Object(i.render)(n.a.createElement(N.a,{negative:!0}," Invalid account ! please check your email and password"),document.getElementById("FormError")):Object(i.render)(n.a.createElement(N.a,{negative:!0}," Somthing wrong ! try again."),document.getElementById("FormError"))}.bind(Object(R.a)(Object(R.a)(e)))})},e.state={loginEmail:"",loginPassword:""},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return this.state.auth?n.a.createElement(T.a,{to:"/driver"}):n.a.createElement("div",null,n.a.createElement(E.a,{as:"h3",textAlign:"center",color:"teal"},"DRIVER LOGIN"),n.a.createElement("div",{className:"driverLoginBox"},n.a.createElement(b.a,{columns:1},n.a.createElement(b.a.Row,{columns:1},n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("input",{name:"loginEmail",type:"text",value:this.state.loginEmail,placeholder:"Email Address",onChange:function(t){return e.change(t)},size:"huge"})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("input",{name:"loginPassword",type:"password",value:this.state.loginPassword,placeholder:"Password",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(y.a,{color:"teal",size:"huge",onClick:function(t){return e.onDriverLogin(t)},fluid:!0},"LOGIN"))))))}}]),t}(r.Component),je=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={auth:""},localStorage.removeItem("_auth_driver"),e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=localStorage.getItem("_auth_driver");return console.log("received token",e),n.a.createElement("div",null,e?n.a.createElement("div",null," Driver dashboard "):n.a.createElement("div",null,n.a.createElement(b.a,{container:!0,columns:1,centered:!0},n.a.createElement(b.a.Row,{columns:1},n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement("div",{id:"FormError",className:"FormError"}))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(we,null))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(Ce,null))))))}}]),t}(r.Component),Se=a(103),ke=[{key:"m",text:"Male",value:"male"},{key:"f",text:"Female",value:"female"}],Ie=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).validateRiderApply=function(){var t=[];return 0===e.state.firstName.length?t.push("First name field is empty."):e.state.firstName.length<2?t.push("Your first name is very short."):!1===Se.isAlpha(e.state.firstName)&&t.push("First name needs to be alphabet"),0===e.state.middleName.length?t.push("Father name field is empty."):e.state.middleName.length<2?t.push("Father name is very short"):!1===Se.isAlpha(e.state.middleName)&&t.push("Father name needs to be alphabet"),!1===Se.isEmail(e.state.email)?t.push("Email address is not valid."):0===e.state.email.length&&t.push("Mobile field is empty."),0===e.state.mobile.length?t.push("Mobile field is empty"):!1===Se.isNumeric(e.state.mobile,{no_symbols:!0})?t.push("Mobile number is not valid"):!1===Se.isMobilePhone(e.state.mobile)?t.push("Mobile field is not correct"):e.state.mobile.length<10?t.push("Mobile number needs to be 10 digits"):e.state.mobile.length>10&&t.push("Mobile number needs to be 10 digits"),0===e.state.password.length?t.push("Password field is empty"):!1===Se.isLength(e.state.password,{min:6})?t.push("Password length must not be less than 6 characters"):!1===Se.isLength(e.state.password,{max:15})&&t.push("Password length very long"),0===e.state.gender.length&&t.push("Gender field is not selected"),t},e.change=function(t){e.setState(Object(I.a)({},t.target.name,t.target.value))},e.onChangeGender=function(t,a){e.setState({gender:a.value})},e.onRiderApply=function(t){t.preventDefault();var a=e.validateRiderApply();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(N.a,{negative:!0},r),document.getElementById("FormError"))}else{var o={firstName:e.state.firstName,middleName:e.state.middleName,email:e.state.email,mobile:e.state.mobile,password:e.state.password,gender:e.state.gender};e.riderApply(o),e.setState({firstName:"",middleName:"",email:"",mobile:"",password:"",gender:"",errors:[]})}},e.riderApply=function(t){F.a.ajax({type:"POST",url:"/user/apply",data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){sessionStorage.setItem("_auth_user",e.token),this.setState({auth:e.token}),console.log("token",e.token),console.log("rider applied success",e)}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(R.a)(Object(R.a)(e)))})},e._yes=function(t){e.setState({show_form:!0})},e.state={firstName:"",middleName:"",email:"",mobile:"",password:"",gender:"",errors:[],auth:!1,show_form:!1},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return this.state.auth?n.a.createElement(T.a,{to:"/user"}):n.a.createElement("div",null,!1===this.state.show_form?n.a.createElement("div",{className:"driverLoginBox"},n.a.createElement(b.a,{columns:1,centered:!0,stackable:!0},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(y.a,{color:"teal",size:"huge",onClick:function(t){return e._yes(t)},fluid:!0},"NEW PASSENGER"))))):n.a.createElement("div",{className:"driverLoginBox"},n.a.createElement(b.a,{columns:1},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"First Name"),n.a.createElement("input",{name:"firstName",type:"text",value:this.state.firstName,placeholder:"First Name",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"Father Name"),n.a.createElement("input",{name:"middleName",type:"text",value:this.state.middleName,placeholder:"Father Name",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"Email"),n.a.createElement("input",{name:"email",type:"text",value:this.state.email,placeholder:"email address",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"Mobile"),n.a.createElement("input",{name:"mobile",type:"text",value:this.state.mobile,placeholder:"Mobile number",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("label",null,"Password"),n.a.createElement("input",{name:"password",type:"password",value:this.state.password,placeholder:"Password",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement(L.a.Select,{name:"gender",fluid:!0,label:"Gender",options:ke,placeholder:"Gender",onChange:this.onChangeGender})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(y.a,{color:"teal",size:"huge",onClick:function(t){return e.onRiderApply(t)},fluid:!0},"NEW PASSENGER"))))))}}]),t}(r.Component),Re=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).validateRiderLogin=function(){var t=[];return 0===e.state.loginEmail.length&&t.push("Email field is empty."),0===e.state.loginPassword.length&&t.push("Password field is empty."),t},e.change=function(t){e.setState(Object(I.a)({},t.target.name,t.target.value))},e.onRiderLogin=function(t){t.preventDefault();var a=e.validateRiderLogin();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(N.a,{negative:!0},r),document.getElementById("FormError"))}else{var o={email:e.state.loginEmail,password:e.state.loginPassword};e.riderLogin(o),e.setState({loginEmail:"",loginPassword:"",errors:[]})}},e.riderLogin=function(t){F.a.ajax({type:"POST",url:"/user/login",data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){console.log("this user login",e),sessionStorage.setItem("_auth_user",e.token),this.setState({auth:e.token})}.bind(Object(R.a)(Object(R.a)(e))),error:function(e,t,a){"Unauthorized"===a.toString()?Object(i.render)(n.a.createElement(N.a,{negative:!0}," Invalid account ! please check your email and password"),document.getElementById("FormError")):Object(i.render)(n.a.createElement(N.a,{negative:!0}," Somthing wrong ! try again."),document.getElementById("FormError"))}.bind(Object(R.a)(Object(R.a)(e)))})},e.state={loginEmail:"",loginPassword:""},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return this.state.auth?n.a.createElement(T.a,{to:"/user"}):n.a.createElement("div",null,n.a.createElement(E.a,{as:"h3",textAlign:"center",color:"teal"},"PASSENGER LOGIN"),n.a.createElement("div",{className:"driverLoginBox"},n.a.createElement(b.a,{columns:1},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("input",{name:"loginEmail",type:"text",value:this.state.loginEmail,placeholder:"Email Address",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(L.a,null,n.a.createElement("input",{name:"loginPassword",type:"password",value:this.state.loginPassword,placeholder:"Password",onChange:function(t){return e.change(t)}})))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(y.a,{color:"green",size:"huge",onClick:function(t){return e.onRiderLogin(t)},fluid:!0},"LOGIN"))))))}}]),t}(r.Component),Ne=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={auth:""},localStorage.removeItem("_auth_user"),e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement(b.a,{container:!0,columns:1,centered:!0},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement("div",{id:"FormError",className:"FormError"}))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(Re,null))),n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{mobile:18,tablet:18,computer:18},n.a.createElement(Ie,null))))))}}]),t}(r.Component),xe=(a(569),function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={lat:9.0089,lng:38.7629,zoom:16},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){this.state.lat,this.state.lng;return n.a.createElement("div",null,n.a.createElement(m.a,null,n.a.createElement("div",null,n.a.createElement(p.a,null,n.a.createElement(g.a,{path:"/",component:O,exact:!0}),n.a.createElement(g.a,{path:"/user/login",component:Ne,exact:!0}),n.a.createElement(g.a,{path:"/user",component:X,exact:!0}),n.a.createElement(g.a,{path:"/driver",component:ye,exact:!0}),n.a.createElement(g.a,{path:"/driver/login",component:je,exact:!0})))))}}]),t}(n.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(xe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[278,2,1]]]);
//# sourceMappingURL=main.ce8167df.chunk.js.map