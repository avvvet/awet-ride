(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,a){e.exports=a(218)},109:function(e,t,a){},211:function(e,t){},216:function(e,t,a){},218:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(17),l=a.n(i),o=(a(109),a(9)),s=a(10),c=a(12),d=a(11),m=a(13),u=a(234),p=a(236),g=a(219),h=a(237),f=a(231),E=a(220),v=a(221),b=a(222),y=a(223),_=(r.Component,a(21)),O=a(3),j=a(8),k=a.n(j),x=a(63),S=a(224),w=a(225),N=a(226),I=a(61),C=a(15),P=a.n(C),L=a(50),R=a.n(L),T=k.a.icon({iconUrl:"/assets/awet-rider-m.png",shadowUrl:"",iconSize:[40,40],shadowSize:[50,64],iconAnchor:[12,50],shadowAnchor:[4,62],popupAnchor:[-1,-45]}),F=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).userCurrentLocation=function(){console.log("user current location"),new Promise(function(t,a){console.log("user current latlng",e.state.current_latlng,e.state.last_current_latlng),e.state.map.locate({setView:!0,maxZoom:17}),t(!0)}).then(function(t){if(!R.a.isEqual(e.state.current_latlng,e.state.last_current_latlng)){e.setState({last_current_latlng:e.state.current_latlng});var a={_latlng:"POINT(".concat(e.state.current_latlng.lat," ").concat(e.state.current_latlng.lng,")")},r=localStorage.getItem("_auth_user");P.a.ajax({type:"POST",url:"/user/updateLocation",headers:{"x-auth":r},data:JSON.stringify(a),contentType:"application/json",success:function(e,t,a){}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})}})},e.getList=function(){fetch("/api/getList").then(function(e){return e.json()}).then(function(t){return e.setState({list:t})})},e.getDrivers=function(t){var a=k.a.icon({iconUrl:"/assets/awet-ride-marker-1.png",shadowUrl:"",iconSize:[80,49],shadowSize:[50,64],iconAnchor:[22,94],shadowAnchor:[4,62],popupAnchor:[-3,-76]});P.a.ajax({type:"GET",url:"/drivers",contentType:"application/json",success:function(e,t,r){var n=this.state.markerGroup;if(e)for(var i=0;i<e.length;i++)k.a.marker([e[i].currentLocation[0],e[i].currentLocation[1]],{icon:a}).bindPopup(e[i].firstName+" "+e[i].middleName+" <br> Plate : "+e[i].plateNo).addTo(n)}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.log("getdrivers error",a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.getNearestDrivers=function(t){var a={pickup_latlng:"POINT(".concat(e.state.pickup_latlng.lat," ").concat(e.state.pickup_latlng.lng,")")};P.a.ajax({type:"POST",url:"/drivers/nearest",data:JSON.stringify(a),contentType:"application/json",success:function(e,a,r){console.log("nearest driver",e,"pickup",t),e.length>0&&this.setState({_nearest_driver_token:e[0].token,_nearest_driver_distance:e[0].distance})}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.error("erroorror",a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.getUser=function(t){P.a.ajax({type:"GET",url:"/user/get",headers:{"x-auth":t},contentType:"application/json",success:function(e,t,a){e&&"undefined"!==typeof e.user&&this.setState({user:e,isLogedIn:!0})}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.log("getdriver",a.toString()),console.error(e,t,a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.findRoute=function(t,a){document.getElementById("ride-route-status").innerHTML="Please wait ...",document.getElementById("ride-route-status").style.visibility="visible",document.getElementById("ride-price-dashboard").style.visibility="hidden",document.getElementById("ride-route-try").style.visibility="hidden";var r=e.state.map;e.routeControl&&(r.removeControl(e.routeControl),e.routeControl=null),e.routeControl=k.a.Routing.control({waypoints:[k.a.latLng(t),k.a.latLng(a)],routeWhileDragging:!1,addWaypoints:!1,show:!1,showAlternatives:!1,createMarker:function(){return null}}).on("routesfound",e.routeFound).on("routingerror",function(e){console.log(e.error.status),-1===e.error.status&&(document.getElementById("ride-price-dashboard").style.visibility="hidden",document.getElementById("ride-route-status").style.visibility="hidden",document.getElementById("ride-route-try").style.visibility="visible")}).addTo(r)},e.routeFound=function(t){var a=t.routes,r=a[0].summary.totalDistance,n=a[0].summary.totalTime;r=(r/1e3).toFixed(2);var i=function(e){var t=e/3600,a=Math.floor(t),r=60*(t-a),n=Math.round(r);return(a>0?a+" hr":"")+(n>0?n+" min":"")}(Number.parseInt(n));var l=(10*r).toFixed(2);e.setState({route_distance:Number.parseFloat(r).toFixed(2),route_price:l,route_time:n,route_time_string:i,isRouteFound:!0}),document.getElementById("ride-route-try").style.visibility="hidden",document.getElementById("ride-route-status").style.visibility="hidden",document.getElementById("ride-price-dashboard").style.visibility="visible"},e.rideRequest=function(t){var a={user_id:localStorage.getItem("_auth_user"),driver_id:e.state._nearest_driver_token,pickup_latlng:"POINT(".concat(e.state.pickup_latlng.lat," ").concat(e.state.pickup_latlng.lng,")"),dropoff_latlng:"POINT(".concat(e.state.dropoff_latlng.lat," ").concat(e.state.dropoff_latlng.lng,")"),route_distance:e.state.route_distance,route_time:e.state.route_time,route_price:e.state.route_price,status:1};P.a.ajax({type:"POST",url:"/ride/rideRequest",data:JSON.stringify(a),contentType:"application/json",success:function(e,t,a){document.getElementById("ride-price-dashboard").style.visibility="hidden",document.getElementById("ride-request-dashboard").style.visibility="visible",this.timerB=setInterval(this.checkRideStatus,7e3),console.log("ride request",e)}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.change=function(t){e.setState(Object(_.a)({},t.target.name,t.target.value))},e.checkRideStatus=function(){P.a.ajax({type:"POST",url:"/ride/check_ride_user",headers:{"x-auth":localStorage.getItem("_auth_user")},data:JSON.stringify({status:7}),contentType:"application/json",success:function(e,t,a){var r=this;if(e)if(1===e.status);else if(7===e.status){new Promise(function(t,a){r.setState({_driverImage:"/assets/awet-ride-driver.jpeg",_driverCarImage:"/assets/awet-ride.jpeg",_driverName:e.driver.firstName+" "+e.driver.middleName,_driverPlateNo:"02-B78098",_driverMobile:e.driver.mobile,_driverCarModel:"LIFAN J450",_driverCurrentLocation:e.driver.currentLocation.coordinates}),t(!0)}).then(function(){document.getElementById("ride-request-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard").style.visibility="visible"})}else 77===e.status?(document.getElementById("u-driver-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard-2").style.visibility="visible"):0===e.status&&(document.getElementById("ride-request-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard").style.visibility="hidden",document.getElementById("u-driver-dashboard-2").style.visibility="hidden",clearInterval(this.timerB),this.resetRide())}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.resetRide=function(){document.getElementById("ride-price-dashboard").style.visibility="hidden",document.getElementById("ride-route-try").style.visibility="hidden";var t=e.state.map;e.routeControl&&(t.removeControl(e.routeControl),e.routeControl=null),e.state.markerGroup.clearLayers(),e.setState({pickup_flag:"off",dropoff_flag:"off",isRouteFound:!1,rideCompleteFlag:!1}),t.locate({setView:!0,maxZoom:15})},e.cancelRide=function(){document.getElementById("ride-price-dashboard").style.visibility="hidden";var t=e.state.map;e.routeControl&&(t.removeControl(e.routeControl),e.routeControl=null),e.state.markerGroup.clearLayers(),e.setState({pickup_flag:"off",dropoff_flag:"off",isRouteFound:!1,rideCompleteFlag:!1}),t.locate({setView:!0,maxZoom:15})},e.state={current_latlng:{lat:0,lng:0},last_current_latlng:{lat:0,lng:0},isLogedIn:!1,pickup_flag:"off",dropoff_flag:"off",pickup_location:"Select your pickup location",pickup_latlng:{lat:0,lng:0},dropoff_latlng:{lat:0,lng:0},currentLatLng:{lat:0,lng:0},_driverCurrentLocation:{lat:0,lng:0},user:{firstName:"",middleName:"",email:"",mobile:"",status:""},first_time_flag:!1,route_price:0,route_distance:0,route_time:0,route_time_string:0,isRouteFound:!1,map:"",markerGroup:"",list:[],currentDrivers:[],pickupText:"",dropoffText:"",locationFoundFlag:!1,statusFlag:!1,timerWait:"",timerRideStatus:"",_driverImage:"",_driverCarImage:"",_driverName:"",_driverPlateNo:"",_driverMobile:"",_driverCarModel:"",rideCompleteFlag:!1,_nearest_driver_token:"",_nearest_driver_distance:0},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getUser(localStorage.getItem("_auth_user"));var t=k.a.map("mapid").setView([9.0092,38.7645],16);t.locate({setView:!0,maxZoom:17}),this.setState({map:t}),k.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(t),this.setState({markerGroup:(new k.a.LayerGroup).addTo(t)}),this.getDrivers(t),t.on("locationfound",function(a){var r=e.state.markerGroup;e.setState({current_latlng:a.latlng});var n=a.accuracy/1024;n=n.toFixed(2),k.a.marker(a.latlng,{icon:T}).addTo(r).bindPopup("You are "+n+" meters from this point").openPopup(),k.a.circle(a.latlng,n).addTo(r),t.setView(a.latlng,15),e.setState({currentLatLng:a.latlng})}),t.on("locationerror",function(e){alert(e.message)}),t.on("click",function(t){var a=e.state.markerGroup;if(e.setState({first_time_flag:!1}),"off"===e.state.pickup_flag&&(k.a.marker(t.latlng).addTo(a).bindPopup("<div class='popup-title'> Your pickup </div><div class='popup-content'> driver will come here.</div>"),e.setState({pickup_flag:"on",pickup_latlng:t.latlng,first_time_flag:!0})),"off"===e.state.dropoff_flag&&"on"===e.state.pickup_flag&&!1===e.state.first_time_flag&&(k.a.marker(t.latlng).addTo(a).bindPopup("<div class='popup-title'> Your dropoff </div><div class='popup-content'> ride ends here.</div>"),e.setState({dropoff_flag:"on",dropoff_latlng:t.latlng})),"on"===e.state.dropoff_flag&&"on"===e.state.pickup_flag&!1===e.state.isRouteFound){var r=e.state.pickup_latlng,n=e.state.dropoff_latlng;document.getElementById("div-intro").style.visibility="hidden",e.findRoute(r,n)}"on"===e.state.pickup_flag&&e.getNearestDrivers(e.state.pickup_latlng)}),this.timerUserLocation=setInterval(this.userCurrentLocation,1e4)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e,t,a=this;return n.a.createElement("div",null,n.a.createElement("div",{className:"user-info",id:"user-info"},n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,Object(_.a)({xs:4,sm:3},"sm",4),n.a.createElement(E.a,{src:"/assets/awet-rider-m.png",height:35,circle:!0})),n.a.createElement(w.a,(e={xs:4,sm:3},Object(_.a)(e,"sm",4),Object(_.a)(e,"className","colPadding"),e),!0===this.state.isLogedIn?"hi "+this.state.user.firstName:"hi rider"),n.a.createElement(w.a,(t={xs:4,sm:3},Object(_.a)(t,"sm",4),Object(_.a)(t,"className","colPadding"),t),!0===this.state.isLogedIn?n.a.createElement(h.a,{to:"/user/login"},"Logout"):n.a.createElement(h.a,{to:"/user/login"},"Login"))))),n.a.createElement("div",{className:"div-intro",id:"div-intro"},n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,Object(_.a)({xs:12,sm:12},"sm",12),"For ride click your pickup and dropoff from the map.")))),n.a.createElement("div",{className:"ride-price-dashboard",id:"ride-price-dashboard"},n.a.createElement("div",null,n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:4,sm:4,md:4},"Price"),n.a.createElement(w.a,{xs:4,sm:4,md:4},"Distance"),n.a.createElement(w.a,{xs:4,sm:4,md:4},"Time")),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:4,sm:4,md:4},n.a.createElement(N.a,null,this.state.route_price+" br")),n.a.createElement(w.a,{xs:4,sm:4,md:4},n.a.createElement(N.a,null,this.state.route_distance+" km")),n.a.createElement(w.a,{xs:4,sm:4,md:4},n.a.createElement(N.a,null,this.state.route_time_string))),n.a.createElement(S.a,{className:"rowPaddingSm"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{onClick:function(e){return a.rideRequest(a.state.pickup_latlng,e)},bsStyle:"success",bsSize:"small",block:!0},"REQUEST RIDE"))),n.a.createElement(S.a,{className:"rowPaddingSm"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{onClick:function(e){return a.cancelRide(e)},bsStyle:"default",bsSize:"small",block:!0},"CANCEL RIDE")))))),n.a.createElement("div",{className:"ride-request-dashboard shake-ride-request",id:"ride-request-dashboard"},"Connecting nearest drivers ",n.a.createElement("br",null),"wait !"),n.a.createElement("div",{className:"ride-route-status",id:"ride-route-status"}),n.a.createElement("div",{className:"ride-route-try",id:"ride-route-try"},n.a.createElement("strong",null,"Oh! ")," Something wrong. Try again.",n.a.createElement("p",null,n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,{className:"rowPaddingSm"},n.a.createElement(w.a,{xs:6,sm:6,md:6},n.a.createElement(y.a,{onClick:function(e){return a.findRoute(a.state.pickup_latlng,a.state.dropoff_latlng,e)},bsStyle:"warning",bsSize:"small",block:!0},"TRY AGAIN")),n.a.createElement(w.a,{xs:6,sm:6,md:6},n.a.createElement(y.a,{onClick:function(e){return a.resetRide(e)},bsSize:"small",block:!0},"CANCEL")))))),n.a.createElement("div",{className:"u-driver-dashboard shake-ride-to-pickup",id:"u-driver-dashboard"},n.a.createElement("div",{className:"notify-rider",id:"notify-rider"}," Get ready ! driver coming."),n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:4,sm:4,md:4},n.a.createElement(E.a,{src:this.state._driverImage,height:45,circle:!0})),n.a.createElement(w.a,{xs:4,sm:4,md:4},n.a.createElement(E.a,{src:this.state._driverCarImage,height:45,circle:!0})),n.a.createElement(w.a,{xs:4,sm:4,md:4},this.state._driverCarModel," ",this.state._driverPlateNo)),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,sm:6,md:6},this.state._driverName),n.a.createElement(w.a,{xs:6,sm:6,md:6},this.state._driverMobile)))),n.a.createElement("div",{className:"u-driver-dashboard-2 shake-ride-to-pickup",id:"u-driver-dashboard-2"},n.a.createElement("div",{className:"notify-rider",id:"notify-rider"}," Ride inprogress"),n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:4,sm:4,md:4},n.a.createElement(E.a,{src:this.state._driverImage,height:45,circle:!0})),n.a.createElement(w.a,{xs:4,sm:4,md:4},n.a.createElement(E.a,{src:this.state._driverCarImage,height:45,circle:!0})),n.a.createElement(w.a,{xs:4,sm:4,md:4},this.state._driverCarModel," ",this.state._driverPlateNo)),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,sm:6,md:6},this.state._driverName),n.a.createElement(w.a,{xs:6,sm:6,md:6},this.state._driverMobile)))),n.a.createElement("div",{className:"mapid",id:"mapid"}))}}]),t}(r.Component),D=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={pickupAdress:"Lord my God you have plan in my life",pickup_latlng:{lat:0,lng:0}},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(F,{pickupAdress:this.state.pickup_latlng}))}}]),t}(r.Component),B=(a(183),a(184),a(51)),A=a.n(B),M=A()("http://localhost:5000"),U=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).rideRequest=function(t){var a={user_id:"7141",driver_id:"0",pickup_latlng:"POINT(".concat(e.state.pickup_latlng.lat," ").concat(e.state.pickup_latlng.lng,")"),dropoff_latlng:"POINT(".concat(e.state.dropoff_latlng.lat," ").concat(e.state.dropoff_latlng.lng,")"),route_distance:e.state.route_distance,route_time:e.state.route_time,route_price:e.state.route_price,status:1};P.a.ajax({type:"POST",url:"/ride/rideRequest",data:JSON.stringify(a),contentType:"application/json",success:function(e,t,a){console.log("Nearest driver",e),document.getElementById("div-request").style.visibility="visible",this.setState({driver:e}),M.emit("request_driver",{msg:"test"})}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.findRoute=function(t,a){var r=e.state.map;k.a.Routing.control({waypoints:[k.a.latLng(t),k.a.latLng(a)]}).on("routesfound",e.routeFound).addTo(r)},e.routeFound=function(t){var a=t.routes,r=a[0].summary.totalDistance,n=a[0].summary.totalTime;r=Number.parseFloat(r/1e3).toFixed(2);var i=function(e){var t=e/3600,a=Math.floor(t),r=60*(t-a),n=Math.round(r);return(a>0?a+" hr":"")+(n>0?n+" min":"")}(Number.parseInt(n));e.setState({route_distance:Number.parseFloat(r).toFixed(2),route_price:l,route_time:n,isRouteFound:!0});var l=Number.parseFloat(19*r).toFixed(2);document.getElementById("ride_price").innerHTML=l+" Birr",document.getElementById("distance").innerHTML=r+" km",document.getElementById("ride_time").innerHTML=i},e.NearestDriverComponent=function(e){var t=e.driver;return n.a.createElement("div",null,n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,md:6},n.a.createElement(E.a,{src:t.car_pic,height:45,circle:!0})),n.a.createElement(w.a,{xs:6,md:6},n.a.createElement(E.a,{src:t.driver_pic,height:45,circle:!0}))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,md:6},t.model),n.a.createElement(w.a,{xs:6,md:6},t.driver_name)),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,md:6},t.plate),n.a.createElement(w.a,{xs:6,md:6},t.driver_phone))))},e.state={dropoff_flag:!1,pickup_flag:!0,dropoff_location:"Select your pickup location",dropoff_latlng:{lat:9.0092,lng:38.7545},pickup_latlng:{lat:9.0092,lng:38.7645},route_price:0,route_distance:0,route_time:0,isRouteFound:!1,map:"",markersLayer:"",driver:{id:"",driver_name:"",driver_phone:"",model:"",plate:"",car_pic:"",driver_pic:""},socket_data:""},e.rideRequest=e.rideRequest.bind(Object(O.a)(Object(O.a)(e))),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=k.a.map("mapid").setView([9.0092,38.7645],16);this.setState({map:e}),k.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(e);var t=(new k.a.LayerGroup).addTo(e);this.setState({markersLayer:t}),this.setState({pickup_latlng:JSON.parse(localStorage.getItem("session_pickup"))})}},{key:"componentDidUpdate",value:function(){var e,t=this,a=this.state.map,r=this.state.markersLayer;if(a.on("click",function(a){I.reverseGeocode({lat:a.latlng.lat,lon:a.latlng.lng,addressdetails:!0}).then(function(n){r.clearLayers(),e=k.a.marker(a.latlng).addTo(r).bindPopup("<div class='popup-title'> Your dropoff location is </div><div class='popup-content'>"+n.display_name+"</div>").openPopup(),r.addLayer(e),t.setState({dropoff_location:n.display_name,dropoff_latlng:a.latlng,dropoff_flag:!0})}).catch(function(e){console.error(e)})}),this.state.dropoff_flag&&this.state.pickup_flag&!1===this.state.isRouteFound){var n=this.state.pickup_latlng,i=this.state.dropoff_latlng;this.findRoute(n,i)}}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("div",{className:"mapid",id:"mapid"}),n.a.createElement("div",{className:"div-request",id:"div-request"},n.a.createElement(this.NearestDriverComponent,{driver:this.state.driver})),n.a.createElement("div",{className:"div-ride-price"},n.a.createElement("div",null,n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:4,md:4},"Price ",n.a.createElement(N.a,null,n.a.createElement("div",{id:"ride_price"}))),n.a.createElement(w.a,{xs:4,md:4},"Distance ",n.a.createElement(N.a,null,n.a.createElement("div",{id:"distance"}))),n.a.createElement(w.a,{xs:4,md:4},"Time ",n.a.createElement(N.a,null,n.a.createElement("div",{id:"ride_time"})))))),n.a.createElement("div",{id:"div-process",className:"div-process"},n.a.createElement("div",{className:"div-pickup-btn-box"},n.a.createElement(y.a,{onClick:function(t){return e.rideRequest(e.state.pickup_latlng,t)},bsStyle:"success",bsSize:"small"},"Request Driver")))))}}]),t}(r.Component),z=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={dropoff_location:"Lord my God you have plan in my life",dropoff_latlng:{lat:0,lng:0}},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(U,{dropoff_latlng:this.state.dropoff_latlang}))}}]),t}(r.Component),G=(r.Component,r.Component,a(214),A()("http://localhost:5000")),q=a(215),J=q.Howl,V=(q.Howler,new J({src:["/assets/sounds/awet-ride.mp3","/assets/sounds/awet-ride.ogg","/assets/sounds/awet-ride.m4r"],autoplay:!0,loop:!0,volume:0})),W=k.a.icon({iconUrl:"/assets/awet-rider-m.png",shadowUrl:"",iconSize:[50,50],shadowSize:[50,64],iconAnchor:[12,50],shadowAnchor:[4,62],popupAnchor:[-1,-45]}),H=k.a.icon({iconUrl:"/assets/awet-ride-dropoff-marker.png",shadowUrl:"",iconSize:[80,80],shadowSize:[50,64],iconAnchor:[0,75],shadowAnchor:[4,62],popupAnchor:[-3,-75]}),Y=k.a.icon({iconUrl:"/assets/awet-ride-marker-1.png",shadowUrl:"",iconSize:[80,49],shadowSize:[50,64],iconAnchor:[20,20],shadowAnchor:[4,62],popupAnchor:[20,-5]}),Z=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).getDriver=function(t){P.a.ajax({type:"GET",url:"/driver/get",headers:{"x-auth":t},contentType:"application/json",success:function(e,t,a){this.setState({driver:e})}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.log("getdriver",a.toString()),console.error(e,t,a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.socketConnect=function(e){G.on("connect",function(){console.log("client connected"),G.emit("join",e,function(e){e&&alert(e)})}),G.on("driveRequest",function(e){console.log("drive request",e)}),G.on("disconnect",function(){console.log("client disconnected")})},e.socketJoin=function(e){},e.driverCurrentLocation=function(){new Promise(function(t,a){R.a.isEqual(e.state.current_latlng,e.state.last_current_latlng)?a(!0):(console.log("current latlng",e.state.current_latlng,e.state.last_current_latlng),e.state.map.locate({setView:!0,maxZoom:17}),e.setState({last_current_latlng:e.state.current_latlng}),t(!0))}).then(function(t){var a={_latlng:"POINT(".concat(e.state.current_latlng.lat," ").concat(e.state.current_latlng.lng,")")},r=localStorage.getItem("_auth_driver");P.a.ajax({type:"POST",url:"/driver/updateLocation",headers:{"x-auth":r},data:JSON.stringify(a),contentType:"application/json",success:function(e,t,a){}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})})},e.driverRidesInfo=function(){P.a.ajax({type:"POST",url:"/driver/getRidesInfo",headers:{"x-auth":localStorage.getItem("_auth_driver")},data:JSON.stringify({status:777}),contentType:"application/json",success:function(t){t.length>0?(console.log("driver info",t),e.setState({driverName:t[0].firstName,amount:t[0].amount,charge:t[0].charge,total_rides:t[0].total_rides})):e.setState({driverName:e.state.driver.firstName,amount:0,charge:0,total_rides:0})},error:function(e,t,a){console.error("ride completed error",a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.checkForRide=function(){console.log("check for a ride");P.a.ajax({type:"POST",url:"/ride/check_ride_driver",headers:{"x-auth":localStorage.getItem("_auth_driver")},data:JSON.stringify({status:1}),contentType:"application/json"}).done(function(e){}).fail(function(e,t,a){console.log("Error",a)}).always(function(t){t&&(V.volume(.7,e.soundAccept),e.setState({ridePrice:t.route_price,rideDistance:t.route_distance,rideTime:t.route_time,rideUser:t.user.firstName+" "+t.user.middleName,userMobile:t.user.mobile,userPic:"/assets/awet-ride-driver.jpeg"}),document.getElementById("check-ride-dashboard").style.visibility="visible",e.showPickUpLocation(t.pickup_latlng.coordinates),clearInterval(e.timerCheckForRide))})},e.acceptRide=function(){console.log("accept called");P.a.ajax({type:"POST",url:"/ride/accepted",headers:{"x-auth":localStorage.getItem("_auth_driver")},data:JSON.stringify({status:7}),contentType:"application/json",success:function(e,t,a){var r=this;e&&(V.volume(0,this.soundAccept),new Promise(function(t,a){document.getElementById("check-ride-dashboard").style.visibility="hidden",document.getElementById("driver-dashboard").style.visibility="hidden",document.getElementById("driver-pax-action").style.visibility="visible",V.volume(0,r.soundAccept),r.setState({pickup_latlng:e.pickup_latlng.coordinates,dropoff_latlng:e.dropoff_latlng.coordinates}),t()}).then(function(){r.showPickUpLocation(e.pickup_latlng.coordinates)}))}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.error("accept test case error",a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.rideCompleted=function(){P.a.ajax({type:"POST",url:"/ride/completed",headers:{"x-auth":localStorage.getItem("_auth_driver")},data:JSON.stringify({status:777}),contentType:"application/json",success:function(t){(console.log("payment returned",t),t)&&new Promise(function(t,a){document.getElementById("driver-pax-action").style.visibility="hidden",document.getElementById("driver-pax-end-action").style.visibility="hidden",document.getElementById("check-ride-dashboard").style.visibility="hidden";e.state.map;e.state.markerGroup.clearLayers(),e.setState({pickupRoutFlag:!1}),t(!0)}).then(function(){e.driverRidesInfo(),e.timerCheckForRide=setInterval(e.checkForRide,5e3),document.getElementById("driver-dashboard").style.visibility="visible"})},error:function(e,t,a){console.error("ride completed error",a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.paxFound=function(){P.a.ajax({type:"POST",url:"/ride/paxFound",headers:{"x-auth":localStorage.getItem("_auth_driver")},data:JSON.stringify({status:77}),contentType:"application/json",success:function(t){t&&e.showDropOffLocation(e.state.pickup_latlng,e.state.dropoff_latlng)},error:function(e,t,a){console.error("ride completed error",a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.showPickUpLocation=function(t){var a=e.state.map,r=e.state.markerGroup;k.a.marker(t,{icon:W}).addTo(r).bindPopup("Pick passenger here.").openPopup(),a.setView(t,15),e.showPickUpRoute(e.state.currentLatLng,t)},e.showPickUpRoute=function(t,a){if(!e.state.pickupRoutFlag){var r=e.state.map;e.routeControl&&(r.removeControl(e.routeControl),e.routeControl=null),e.routeControl=k.a.Routing.control({waypoints:[k.a.latLng(t),k.a.latLng(a)],routeWhileDragging:!1,addWaypoints:!1,show:!1,createMarker:function(){return null}}).on("routesfound",e.routeFound).addTo(r)}},e.routeFound=function(){e.setState({pickupRoutFlag:!0})},e.showDropOffLocation=function(t,a){new Promise(function(e,t){document.getElementById("driver-pax-action").style.visibility="hidden",document.getElementById("driver-pax-end-action").style.visibility="visible",e(!0)}).then(function(){var r=e.state.map,n=e.state.markerGroup;k.a.marker(t,{icon:W}).addTo(n).bindPopup("Pickup location.").openPopup(),k.a.marker(a,{icon:H}).addTo(n).bindPopup("Final dropoff location.").openPopup(),r.setView(a,15),e.showDropOffRoute(t,a)})},e.showDropOffRoute=function(t,a){var r=e.state.map;r.removeControl(e.routeControl),e.routeControl=k.a.Routing.control({waypoints:[k.a.latLng(t),k.a.latLng(a)],routeWhileDragging:!1,addWaypoints:!1,show:!1,createMarker:function(){return null}}).on("routesfound",e.routeFound).addTo(r)},e.timeConvert=function(e){var t=e/3600,a=Math.floor(t),r=60*(t-a),n=Math.round(r);return(a>0?a+" hr":"")+(n>0?n+" min":"")},e.state={current_latlng:{lat:0,lng:0},last_current_latlng:{lat:0,lng:0},pickup_latlng:"",dropoff_latlng:"",driver_id:"",markerGroup:"",map:"",auth:!1,soundFlag:!1,driver:{firstName:"",middleName:"",email:"",mobile:"",status:""},ridePrice:"",rideDistance:"",rideTime:"",rideUser:"",userMobile:"",userPic:"",driverName:"",amount:"",charge:"",total_rides:""},e.checkForRide=e.checkForRide.bind(Object(O.a)(Object(O.a)(e))),e.getDriver=e.getDriver.bind(Object(O.a)(Object(O.a)(e))),e.driverCurrentLocation=e.driverCurrentLocation.bind(Object(O.a)(Object(O.a)(e))),e.acceptRide=e.acceptRide.bind(Object(O.a)(Object(O.a)(e))),e.rideCompleted=e.rideCompleted.bind(Object(O.a)(Object(O.a)(e))),e.showPickUpLocation=e.showPickUpLocation.bind(Object(O.a)(Object(O.a)(e))),e.showPickUpRoute=e.showPickUpRoute.bind(Object(O.a)(Object(O.a)(e))),e.showDropOffLocation=e.showDropOffLocation.bind(Object(O.a)(Object(O.a)(e))),e.showDropOffRoute=e.showDropOffRoute.bind(Object(O.a)(Object(O.a)(e))),e.timeConvert=e.timeConvert.bind(Object(O.a)(Object(O.a)(e))),e.driverRidesInfo=e.driverRidesInfo.bind(Object(O.a)(Object(O.a)(e))),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getDriver(localStorage.getItem("_auth_driver")),this.setState({auth:localStorage.getItem("_auth_driver")}),this.driverRidesInfo();var t=k.a.map("mapid").setView([9.0092,38.7645],17);t.locate({setView:!0,maxZoom:17}),this.setState({map:t}),k.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(t),this.setState({markerGroup:(new k.a.LayerGroup).addTo(t)}),this.timerCheckForRide=setInterval(this.checkForRide,5e3),this.timerDriverLocation=setInterval(this.driverCurrentLocation,1e4),t.on("locationfound",function(a){var r=e.state.markerGroup;e.setState({current_latlng:a.latlng});var n=a.accuracy/1024;n=n.toFixed(2),k.a.marker(a.latlng,{icon:Y}).addTo(r).bindPopup("You are "+n+" meters from this point").openPopup(),k.a.circle(a.latlng,n).addTo(r),t.setView(a.latlng,17)}),t.on("locationerror",function(e){alert(e.message)})}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("div",{className:"driver-dashboard",id:"driver-dashboard"},n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement("div",{id:"driver_name"},"Hi, ",this.state.driver.firstName))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,sm:6,md:6},"earning"),n.a.createElement(w.a,{xs:6,sm:6,md:6},"ride ")),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,sm:6,md:6},n.a.createElement(N.a,null,this.state.amount+" br")),n.a.createElement(w.a,{xs:6,sm:6,md:6},n.a.createElement(N.a,null,this.state.total_rides))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,sm:6,md:6},"charge "),n.a.createElement(w.a,{xs:6,sm:6,md:6},"account")),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,sm:6,md:6},n.a.createElement(N.a,{className:"charge"},this.state.charge)),n.a.createElement(w.a,{xs:6,sm:6,md:6},n.a.createElement(N.a,{className:"account"},"active"))))),n.a.createElement("div",{className:"check-ride-dashboard shake-ride-request",id:"check-ride-dashboard"},n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:3,sm:3,md:3},n.a.createElement(E.a,{src:this.state.userPic,height:35,circle:!0})),n.a.createElement(w.a,{xs:3,sm:3,md:3},this.state.ridePrice+" br"),n.a.createElement(w.a,{xs:3,sm:3,md:3},this.state.rideDistance+" km"),n.a.createElement(w.a,{xs:3,sm:3,md:3},this.timeConvert(Number.parseInt(this.state.rideTime)))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{onClick:function(t){return e.acceptRide()},bsStyle:"success",bsSize:"large",block:!0},"ACCEPT RIDE"))))),n.a.createElement("div",{id:"driver-pax-action",className:"driver-pax-action shake-ride-to-pickup"},n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:3,sm:3,md:3},n.a.createElement(E.a,{src:this.state.userPic,height:35,circle:!0})),n.a.createElement(w.a,{xs:3,sm:3,md:3},this.state.ridePrice+" br"),n.a.createElement(w.a,{xs:3,sm:3,md:3},this.state.rideDistance+" km"),n.a.createElement(w.a,{xs:3,sm:3,md:3},this.timeConvert(Number.parseInt(this.state.rideTime)))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,sm:6,md:12},this.state.rideUser),n.a.createElement(w.a,{xs:6,sm:6,md:12},this.state.userMobile)),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{onClick:function(t){return e.paxFound()},bsStyle:"success",bsSize:"small",block:!0},"I FOUND THE PASSENGER"))),n.a.createElement(S.a,{className:"rowPadding"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{onClick:function(t){return e.acceptRide()},bsSize:"small",block:!0},"CANCEL RIDE"))))),n.a.createElement("div",{id:"driver-pax-end-action",className:"driver-pax-end-action shake-finish-ride"},n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:3,sm:3,md:3},n.a.createElement(E.a,{src:this.state.userPic,height:35,circle:!0})),n.a.createElement(w.a,{xs:3,sm:3,md:3},this.state.ridePrice+" br"),n.a.createElement(w.a,{xs:3,sm:3,md:3},this.state.rideDistance+" km"),n.a.createElement(w.a,{xs:3,sm:3,md:3},this.timeConvert(Number.parseInt(this.state.rideTime)))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:6,sm:6,md:12},this.state.rideUser),n.a.createElement(w.a,{xs:6,sm:6,md:12},this.state.userMobile)),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{onClick:function(t){return e.rideCompleted()},bsStyle:"danger",bsSize:"small",block:!0},"RIDE COMPLETED"))),n.a.createElement(S.a,{className:"rowPadding"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{onClick:function(t){return e.acceptRide()},bsSize:"small",block:!0},"CANCEL RIDE"))))),n.a.createElement("div",{className:"mapid",id:"mapid"}))}}]),t}(r.Component),Q=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={latlng:{lat:0,lng:0}},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return console.log("driver page"),n.a.createElement("div",null,n.a.createElement(Z,null))}}]),t}(r.Component),$=a(227),K=a(233),X=a(235),ee=a(228),te=a(229),ae=a(230),re=a(232),ne=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).validateDriverApply=function(){var t=[];return 0===e.state.firstName.length&&t.push("First name field is empty."),0===e.state.middleName.length&&t.push("Father name field is empty."),e.state.firstName.length<3&&t.push("Name field need to be at least 2 characters."),-1===e.state.email.indexOf("@")&&t.push("Email address is not valid."),0===e.state.mobile.length&&t.push("Mobile field is empty."),t},e.change=function(t){e.setState(Object(_.a)({},t.target.name,t.target.value))},e.onDriverApply=function(t){t.preventDefault();var a=e.validateDriverApply();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(X.a,{bsStyle:"danger"},r),document.getElementById("FormError"))}else{var l={firstName:e.state.firstName,middleName:e.state.middleName,email:e.state.email,mobile:e.state.mobile,password:e.state.password,re_password:e.state.re_password,plateNo:e.state.plateNo};e.driverApply(l),e.setState({firstName:"",middleName:"",email:"",mobile:"",password:"",re_password:"",plateNo:"",errors:[]})}},e.driverApply=function(t){P.a.ajax({type:"POST",url:"/driver/apply",data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){localStorage.setItem("_auth_driver",e.token),this.setState({auth:e.token}),console.log("token",e.token),console.log("driver applied success",e)}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.state={firstName:"",middleName:"",email:"",mobile:"",password:"",re_password:"",plateNo:"",errors:[],auth:!1},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return this.state.auth?n.a.createElement(K.a,{to:"/driver"}):n.a.createElement("div",null,n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement("div",null,n.a.createElement($.a,null,"NEW DRIVER",n.a.createElement(ee.a,{placement:"bottom",className:"in",id:"tooltip-bottom"},"New driver apply here."))))),n.a.createElement("form",null,n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"First Name"),n.a.createElement(re.a,{name:"firstName",type:"text",value:this.state.firstName,placeholder:"First Name",onChange:function(t){return e.change(t)}}))),n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Father Name"),n.a.createElement(re.a,{name:"middleName",type:"text",value:this.state.middleName,placeholder:"Father Name",onChange:function(t){return e.change(t)}})))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Email"),n.a.createElement(re.a,{name:"email",type:"text",value:this.state.email,placeholder:"email address",onChange:function(t){return e.change(t)}}))),n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Mobile"),n.a.createElement(re.a,{name:"mobile",type:"text",value:this.state.mobile,placeholder:"Mobile number",onChange:function(t){return e.change(t)}})))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Password"),n.a.createElement(re.a,{name:"password",type:"password",value:this.state.password,placeholder:"Password",onChange:function(t){return e.change(t)}}))),n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Retype Password"),n.a.createElement(re.a,{name:"re_password",type:"password",value:this.state.re_password,placeholder:"Retype password",onChange:function(t){return e.change(t)}})))),n.a.createElement(S.a,{className:"text-center"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{type:"submit",bsSize:"large",bsStyle:"success",onClick:function(t){return e.onDriverApply(t)}},"APPLY TO DRIVE"))))))}}]),t}(r.Component),ie=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).validateDriverLogin=function(){var t=[];return 0===e.state.loginEmail.length&&t.push("Email field is empty."),0===e.state.loginPassword.length&&t.push("Password field is empty."),t},e.change=function(t){e.setState(Object(_.a)({},t.target.name,t.target.value))},e.onDriverLogin=function(t){t.preventDefault();var a=e.validateDriverLogin();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(X.a,{bsStyle:"danger"},r),document.getElementById("FormError"))}else{var l={email:e.state.loginEmail,password:e.state.loginPassword};e.driverLogin(l),e.setState({loginEmail:"",loginPassword:"",errors:[]})}},e.driverLogin=function(t){console.log("test",t),P.a.ajax({type:"POST",url:"/driver/login",data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){localStorage.setItem("_auth_driver",e.token),this.setState({auth:e.token})}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.log("errrrr",a.toString()),"Unauthorized"===a.toString()?Object(i.render)(n.a.createElement(X.a,{bsStyle:"danger",onDismiss:this.handleDismiss}," Invalid account ! please check your email and password"),document.getElementById("FormError")):Object(i.render)(n.a.createElement(X.a,{bsStyle:"danger",onDismiss:this.handleDismiss}," Somthing wrong ! try again."),document.getElementById("FormError"))}.bind(Object(O.a)(Object(O.a)(e)))})},e.state={loginEmail:"",loginPassword:""},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return this.state.auth?n.a.createElement(K.a,{to:"/driver"}):n.a.createElement("div",null,n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement($.a,null,"LOGIN",n.a.createElement(ee.a,{placement:"bottom",className:"in",id:"tooltip-bottom"},"Exsting driver login here.")))),n.a.createElement("form",null,n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Email"),n.a.createElement(re.a,{name:"loginEmail",type:"text",value:this.state.loginEmail,placeholder:"Email Address",onChange:function(t){return e.change(t)}}))),n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Password"),n.a.createElement(re.a,{name:"loginPassword",type:"password",value:this.state.loginPassword,placeholder:"Password",onChange:function(t){return e.change(t)}})))),n.a.createElement(S.a,{className:"text-center"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{type:"submit",bsSize:"large",bsStyle:"primary",onClick:function(t){return e.onDriverLogin(t)}},"LOGIN"))))))}}]),t}(r.Component),le=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={auth:""},localStorage.removeItem("_auth_driver"),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=localStorage.getItem("_auth_driver");return console.log("received token",e),n.a.createElement("div",null,e?n.a.createElement("div",null," Driver dashboard "):n.a.createElement("div",null,n.a.createElement(x.a,null,n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement($.a,null,"AWET"))),n.a.createElement(S.a,{className:"text-center"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement("div",{id:"FormError"}))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement("div",{className:"driverApplyBox"},n.a.createElement(ne,null))),n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement("div",{className:"driverLoginBox"},n.a.createElement(ie,null)))))))}}]),t}(r.Component),oe=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).validateRiderApply=function(){var t=[];return 0===e.state.firstName.length&&t.push("First name field is empty."),0===e.state.middleName.length&&t.push("Father name field is empty."),e.state.firstName.length<3&&t.push("Name field need to be at least 2 characters."),-1===e.state.email.indexOf("@")&&t.push("Email address is not valid."),0===e.state.mobile.length&&t.push("Mobile field is empty."),t},e.change=function(t){e.setState(Object(_.a)({},t.target.name,t.target.value))},e.onRiderApply=function(t){t.preventDefault();var a=e.validateRiderApply();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(X.a,{bsStyle:"danger"},r),document.getElementById("FormError"))}else{var l={firstName:e.state.firstName,middleName:e.state.middleName,email:e.state.email,mobile:e.state.mobile,password:e.state.password,re_password:e.state.re_password};e.riderApply(l),e.setState({firstName:"",middleName:"",email:"",mobile:"",password:"",re_password:"",errors:[]})}},e.riderApply=function(t){P.a.ajax({type:"POST",url:"/user/apply",data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){localStorage.setItem("_auth_user",e.token),this.setState({auth:e.token}),console.log("token",e.token),console.log("rider applied success",e)}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){console.error(e,t,a.toString())}.bind(Object(O.a)(Object(O.a)(e)))})},e.state={firstName:"",middleName:"",email:"",mobile:"",password:"",re_password:"",errors:[],auth:!1},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return this.state.auth?n.a.createElement(K.a,{to:"/"}):n.a.createElement("div",null,n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement("div",null,n.a.createElement($.a,null,"NEW USER",n.a.createElement(ee.a,{placement:"bottom",className:"in",id:"tooltip-bottom"},"New user apply here."))))),n.a.createElement("form",null,n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"First Name"),n.a.createElement(re.a,{name:"firstName",type:"text",value:this.state.firstName,placeholder:"First Name",onChange:function(t){return e.change(t)}}))),n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Father Name"),n.a.createElement(re.a,{name:"middleName",type:"text",value:this.state.middleName,placeholder:"Father Name",onChange:function(t){return e.change(t)}})))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Email"),n.a.createElement(re.a,{name:"email",type:"text",value:this.state.email,placeholder:"email address",onChange:function(t){return e.change(t)}}))),n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Mobile"),n.a.createElement(re.a,{name:"mobile",type:"text",value:this.state.mobile,placeholder:"Mobile number",onChange:function(t){return e.change(t)}})))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Password"),n.a.createElement(re.a,{name:"password",type:"password",value:this.state.password,placeholder:"Password",onChange:function(t){return e.change(t)}}))),n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Re-Password"),n.a.createElement(re.a,{name:"re_password",type:"password",value:this.state.re_password,placeholder:"Retype password",onChange:function(t){return e.change(t)}})))),n.a.createElement(S.a,{className:"text-center"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{type:"submit",bsSize:"large",bsStyle:"success",onClick:function(t){return e.onRiderApply(t)},block:!0},"APPLY TO RIDE"))))))}}]),t}(r.Component),se=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).validateRiderLogin=function(){var t=[];return 0===e.state.loginEmail.length&&t.push("Email field is empty."),0===e.state.loginPassword.length&&t.push("Password field is empty."),t},e.change=function(t){e.setState(Object(_.a)({},t.target.name,t.target.value))},e.onRiderLogin=function(t){t.preventDefault();var a=e.validateRiderLogin();if(a.length>0){var r=e.getErrorList(a);Object(i.render)(n.a.createElement(X.a,{bsStyle:"danger"},r),document.getElementById("FormError"))}else{var l={email:e.state.loginEmail,password:e.state.loginPassword};e.riderLogin(l),e.setState({loginEmail:"",loginPassword:"",errors:[]})}},e.riderLogin=function(t){P.a.ajax({type:"POST",url:"/user/login",data:JSON.stringify(t),contentType:"application/json",success:function(e,t,a){localStorage.setItem("_auth_user",e.token),this.setState({auth:e.token})}.bind(Object(O.a)(Object(O.a)(e))),error:function(e,t,a){"Unauthorized"===a.toString()?Object(i.render)(n.a.createElement(X.a,{bsStyle:"danger",onDismiss:this.handleDismiss}," Invalid account ! please check your email and password"),document.getElementById("FormError")):Object(i.render)(n.a.createElement(X.a,{bsStyle:"danger",onDismiss:this.handleDismiss}," Somthing wrong ! try again."),document.getElementById("FormError"))}.bind(Object(O.a)(Object(O.a)(e)))})},e.state={loginEmail:"",loginPassword:""},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getErrorList",value:function(e){var t=0;return e.map(function(e){return n.a.createElement("li",{key:t++},e)})}},{key:"render",value:function(){var e=this;return this.state.auth?n.a.createElement(K.a,{to:"/"}):n.a.createElement("div",null,n.a.createElement(x.a,{fluid:!0},n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement($.a,null,"LOGIN",n.a.createElement(ee.a,{placement:"bottom",className:"in",id:"tooltip-bottom"},"Exsting user login here.")))),n.a.createElement("form",null,n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Email"),n.a.createElement(re.a,{name:"loginEmail",type:"text",value:this.state.loginEmail,placeholder:"Email Address",onChange:function(t){return e.change(t)}}))),n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(te.a,null,n.a.createElement(ae.a,null,"Password"),n.a.createElement(re.a,{name:"loginPassword",type:"password",value:this.state.loginPassword,placeholder:"Password",onChange:function(t){return e.change(t)}})))),n.a.createElement(S.a,{className:"text-center"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement(y.a,{type:"submit",bsSize:"large",bsStyle:"primary",onClick:function(t){return e.onRiderLogin(t)},block:!0},"LOGIN"))))))}}]),t}(r.Component),ce=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={auth:""},localStorage.removeItem("_auth_user"),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement(x.a,null,n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement($.a,null,"AWET"))),n.a.createElement(S.a,{className:"text-center"},n.a.createElement(w.a,{xs:12,sm:12,md:12},n.a.createElement("div",{id:"FormError"}))),n.a.createElement(S.a,null,n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement("div",{className:"riderLoginBox"},n.a.createElement(se,null))),n.a.createElement(w.a,{xs:12,sm:6,md:6},n.a.createElement("div",{className:"riderApplyBox"},n.a.createElement(oe,null)))))))}}]),t}(r.Component),de=(a(216),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={lat:9.0089,lng:38.7629,zoom:16},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){this.state.lat,this.state.lng;return n.a.createElement("div",null,n.a.createElement(u.a,null,n.a.createElement("div",null,n.a.createElement(p.a,null,n.a.createElement(g.a,{path:"/",component:D,exact:!0}),n.a.createElement(g.a,{path:"/dropoff",component:z,exact:!0}),n.a.createElement(g.a,{path:"/driver",component:Q,exact:!0}),n.a.createElement(g.a,{path:"/driver/login",component:le,exact:!0}),n.a.createElement(g.a,{path:"/user/login",component:ce,exact:!0})))))}}]),t}(n.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[104,2,1]]]);
//# sourceMappingURL=main.968b3105.chunk.js.map